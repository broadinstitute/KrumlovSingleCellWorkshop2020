<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>5 The following examples use the PBMC 3k dataset | ANALYSIS OF SINGLE CELL RNA-SEQ DATA</title>
  <meta name="description" content="5 The following examples use the PBMC 3k dataset | ANALYSIS OF SINGLE CELL RNA-SEQ DATA" />
  <meta name="generator" content="bookdown 0.16 and GitBook 2.6.7" />

  <meta property="og:title" content="5 The following examples use the PBMC 3k dataset | ANALYSIS OF SINGLE CELL RNA-SEQ DATA" />
  <meta property="og:type" content="book" />
  <meta property="og:url" content="https://broadinstitute.github.io/KrumlovSingleCellWorkship2020/" />
  <meta property="og:image" content="https://broadinstitute.github.io/KrumlovSingleCellWorkship2020/images/cover.png" />
  
  <meta name="github-repo" content="broadinstitute/KrumlovSingleCellWorkship2020" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="5 The following examples use the PBMC 3k dataset | ANALYSIS OF SINGLE CELL RNA-SEQ DATA" />
  
  
  <meta name="twitter:image" content="https://broadinstitute.github.io/KrumlovSingleCellWorkship2020/images/cover.png" />

<meta name="author" content="Kirk Gosik" />


<meta name="date" content="2020-01-16" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="data-wrangling-scrnaseq-1.html"/>
<link rel="next" href="identifying-cell-populations-1.html"/>
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />











<style type="text/css">
code.sourceCode > span { display: inline-block; line-height: 1.25; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">ANALYSIS OF SINGLE CELL RNA-SEQ DATA</a></li>

<li class="divider"></li>
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> Introduction</a><ul>
<li class="chapter" data-level="1.1" data-path="index.html"><a href="index.html#course-overview"><i class="fa fa-check"></i><b>1.1</b> COURSE OVERVIEW</a></li>
<li class="chapter" data-level="1.2" data-path="index.html"><a href="index.html#targeted-audience-assumed-background"><i class="fa fa-check"></i><b>1.2</b> TARGETED AUDIENCE &amp; ASSUMED BACKGROUND</a></li>
<li class="chapter" data-level="1.3" data-path="index.html"><a href="index.html#course-format"><i class="fa fa-check"></i><b>1.3</b> COURSE FORMAT</a></li>
<li class="chapter" data-level="1.4" data-path="index.html"><a href="index.html#getting-started"><i class="fa fa-check"></i><b>1.4</b> Getting Started</a></li>
<li class="chapter" data-level="1.5" data-path="index.html"><a href="index.html#session-content"><i class="fa fa-check"></i><b>1.5</b> SESSION CONTENT</a><ul>
<li class="chapter" data-level="1.5.1" data-path="index.html"><a href="index.html#introduction-1"><i class="fa fa-check"></i><b>1.5.1</b> Introduction</a></li>
<li class="chapter" data-level="1.5.2" data-path="index.html"><a href="index.html#transcriptome-quantification"><i class="fa fa-check"></i><b>1.5.2</b> Transcriptome Quantification</a></li>
<li class="chapter" data-level="1.5.3" data-path="index.html"><a href="index.html#expression-qc-and-normalization"><i class="fa fa-check"></i><b>1.5.3</b> Expression QC and Normalization</a></li>
<li class="chapter" data-level="1.5.4" data-path="index.html"><a href="index.html#data-wrangling-scrnaseq"><i class="fa fa-check"></i><b>1.5.4</b> Data Wrangling scRNAseq</a></li>
<li class="chapter" data-level="1.5.5" data-path="index.html"><a href="index.html#identifying-cell-populations"><i class="fa fa-check"></i><b>1.5.5</b> Identifying Cell Populations</a></li>
<li class="chapter" data-level="1.5.6" data-path="index.html"><a href="index.html#feature-selection-and-cluster-analysis"><i class="fa fa-check"></i><b>1.5.6</b> Feature Selection and Cluster Analysis</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="2" data-path="transcriptome-quantification-1.html"><a href="transcriptome-quantification-1.html"><i class="fa fa-check"></i><b>2</b> Transcriptome Quantification</a><ul>
<li class="chapter" data-level="2.1" data-path="transcriptome-quantification-1.html"><a href="transcriptome-quantification-1.html#google-slides"><i class="fa fa-check"></i><b>2.1</b> Google Slides</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="expression-qc-and-normalization-1.html"><a href="expression-qc-and-normalization-1.html"><i class="fa fa-check"></i><b>3</b> Expression QC and Normalization</a><ul>
<li class="chapter" data-level="3.1" data-path="expression-qc-and-normalization-1.html"><a href="expression-qc-and-normalization-1.html#google-slides-1"><i class="fa fa-check"></i><b>3.1</b> Google Slides</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="data-wrangling-scrnaseq-1.html"><a href="data-wrangling-scrnaseq-1.html"><i class="fa fa-check"></i><b>4</b> Data Wrangling scRNAseq</a><ul>
<li class="chapter" data-level="4.1" data-path="data-wrangling-scrnaseq-1.html"><a href="data-wrangling-scrnaseq-1.html#goal"><i class="fa fa-check"></i><b>4.1</b> Goal</a></li>
<li class="chapter" data-level="4.2" data-path="data-wrangling-scrnaseq-1.html"><a href="data-wrangling-scrnaseq-1.html#introduction-2"><i class="fa fa-check"></i><b>4.2</b> Introduction</a><ul>
<li class="chapter" data-level="4.2.1" data-path="data-wrangling-scrnaseq-1.html"><a href="data-wrangling-scrnaseq-1.html#load-necessary-packages"><i class="fa fa-check"></i><b>4.2.1</b> Load necessary packages</a></li>
<li class="chapter" data-level="4.2.2" data-path="data-wrangling-scrnaseq-1.html"><a href="data-wrangling-scrnaseq-1.html#read-in-nsclc-counts-matrix."><i class="fa fa-check"></i><b>4.2.2</b> Read in NSCLC counts matrix.</a></li>
<li class="chapter" data-level="4.2.3" data-path="data-wrangling-scrnaseq-1.html"><a href="data-wrangling-scrnaseq-1.html#lets-examine-the-sparse-counts-matrix"><i class="fa fa-check"></i><b>4.2.3</b> Let’s examine the sparse counts matrix</a></li>
<li class="chapter" data-level="4.2.4" data-path="data-wrangling-scrnaseq-1.html"><a href="data-wrangling-scrnaseq-1.html#how-big-is-the-matrix"><i class="fa fa-check"></i><b>4.2.4</b> How big is the matrix?</a></li>
<li class="chapter" data-level="4.2.5" data-path="data-wrangling-scrnaseq-1.html"><a href="data-wrangling-scrnaseq-1.html#how-much-memory-does-a-sparse-matrix-take-up-relative-to-a-dense-matrix"><i class="fa fa-check"></i><b>4.2.5</b> How much memory does a sparse matrix take up relative to a dense matrix?</a></li>
</ul></li>
<li class="chapter" data-level="4.3" data-path="data-wrangling-scrnaseq-1.html"><a href="data-wrangling-scrnaseq-1.html#filtering-low-quality-cells"><i class="fa fa-check"></i><b>4.3</b> Filtering low-quality cells</a><ul>
<li class="chapter" data-level="4.3.1" data-path="data-wrangling-scrnaseq-1.html"><a href="data-wrangling-scrnaseq-1.html#look-at-the-summary-counts-for-genes-and-cells"><i class="fa fa-check"></i><b>4.3.1</b> Look at the summary counts for genes and cells</a></li>
<li class="chapter" data-level="4.3.2" data-path="data-wrangling-scrnaseq-1.html"><a href="data-wrangling-scrnaseq-1.html#plot-cells-ranked-by-their-number-of-detected-genes."><i class="fa fa-check"></i><b>4.3.2</b> Plot cells ranked by their number of detected genes.</a></li>
</ul></li>
<li class="chapter" data-level="4.4" data-path="data-wrangling-scrnaseq-1.html"><a href="data-wrangling-scrnaseq-1.html#beginning-with-seurat"><i class="fa fa-check"></i><b>4.4</b> Beginning with Seurat:</a><ul>
<li class="chapter" data-level="4.4.1" data-path="data-wrangling-scrnaseq-1.html"><a href="data-wrangling-scrnaseq-1.html#creating-a-seurat-object"><i class="fa fa-check"></i><b>4.4.1</b> Creating a seurat object</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="5" data-path="the-following-examples-use-the-pbmc-3k-dataset.html"><a href="the-following-examples-use-the-pbmc-3k-dataset.html"><i class="fa fa-check"></i><b>5</b> The following examples use the PBMC 3k dataset</a><ul>
<li class="chapter" data-level="5.1" data-path="the-following-examples-use-the-pbmc-3k-dataset.html"><a href="the-following-examples-use-the-pbmc-3k-dataset.html#preprocessing-step-1-filter-out-low-quality-cells"><i class="fa fa-check"></i><b>5.1</b> Preprocessing step 1 : Filter out low-quality cells</a></li>
<li class="chapter" data-level="5.2" data-path="the-following-examples-use-the-pbmc-3k-dataset.html"><a href="the-following-examples-use-the-pbmc-3k-dataset.html#examine-contents-of-seurat-object"><i class="fa fa-check"></i><b>5.2</b> Examine contents of Seurat object</a><ul>
<li class="chapter" data-level="5.2.1" data-path="the-following-examples-use-the-pbmc-3k-dataset.html"><a href="the-following-examples-use-the-pbmc-3k-dataset.html#preprocessing-step-2-expression-normalization"><i class="fa fa-check"></i><b>5.2.1</b> Preprocessing step 2 : Expression normalization</a></li>
</ul></li>
<li class="chapter" data-level="5.3" data-path="the-following-examples-use-the-pbmc-3k-dataset.html"><a href="the-following-examples-use-the-pbmc-3k-dataset.html#detection-of-variable-genes-across-the-single-cells"><i class="fa fa-check"></i><b>5.3</b> Detection of variable genes across the single cells</a></li>
<li class="chapter" data-level="5.4" data-path="the-following-examples-use-the-pbmc-3k-dataset.html"><a href="the-following-examples-use-the-pbmc-3k-dataset.html#gene-set-expression-across-cells"><i class="fa fa-check"></i><b>5.4</b> Gene set expression across cells</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="identifying-cell-populations-1.html"><a href="identifying-cell-populations-1.html"><i class="fa fa-check"></i><b>6</b> Identifying Cell Populations</a><ul>
<li class="chapter" data-level="6.1" data-path="identifying-cell-populations-1.html"><a href="identifying-cell-populations-1.html#google-slides-2"><i class="fa fa-check"></i><b>6.1</b> Google Slides</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="feature-selection-and-cluster-analysis-1.html"><a href="feature-selection-and-cluster-analysis-1.html"><i class="fa fa-check"></i><b>7</b> Feature Selection and Cluster Analysis</a><ul>
<li class="chapter" data-level="7.1" data-path="feature-selection-and-cluster-analysis-1.html"><a href="feature-selection-and-cluster-analysis-1.html#abstract"><i class="fa fa-check"></i><b>7.1</b> Abstract</a></li>
<li class="chapter" data-level="7.2" data-path="feature-selection-and-cluster-analysis-1.html"><a href="feature-selection-and-cluster-analysis-1.html#seurat-tutorial-redo"><i class="fa fa-check"></i><b>7.2</b> Seurat Tutorial Redo</a><ul>
<li class="chapter" data-level="7.2.1" data-path="feature-selection-and-cluster-analysis-1.html"><a href="feature-selection-and-cluster-analysis-1.html#preprocessing-steps"><i class="fa fa-check"></i><b>7.2.1</b> Preprocessing Steps</a></li>
<li class="chapter" data-level="7.2.2" data-path="feature-selection-and-cluster-analysis-1.html"><a href="feature-selection-and-cluster-analysis-1.html#start-of-identifying-cell-types"><i class="fa fa-check"></i><b>7.2.2</b> Start of Identifying Cell Types</a></li>
<li class="chapter" data-level="7.2.3" data-path="feature-selection-and-cluster-analysis-1.html"><a href="feature-selection-and-cluster-analysis-1.html#run-non-linear-dimensional-reduction-umaptsne"><i class="fa fa-check"></i><b>7.2.3</b> Run non-linear dimensional reduction (UMAP/tSNE)</a></li>
</ul></li>
<li class="chapter" data-level="7.3" data-path="feature-selection-and-cluster-analysis-1.html"><a href="feature-selection-and-cluster-analysis-1.html#feature-selection"><i class="fa fa-check"></i><b>7.3</b> Feature Selection</a><ul>
<li class="chapter" data-level="7.3.1" data-path="feature-selection-and-cluster-analysis-1.html"><a href="feature-selection-and-cluster-analysis-1.html#differential-expression-analysis"><i class="fa fa-check"></i><b>7.3.1</b> Differential Expression Analysis</a></li>
<li class="chapter" data-level="7.3.2" data-path="feature-selection-and-cluster-analysis-1.html"><a href="feature-selection-and-cluster-analysis-1.html#check-clusters"><i class="fa fa-check"></i><b>7.3.2</b> Check Clusters</a></li>
<li class="chapter" data-level="7.3.3" data-path="feature-selection-and-cluster-analysis-1.html"><a href="feature-selection-and-cluster-analysis-1.html#view-entire-object-structure"><i class="fa fa-check"></i><b>7.3.3</b> View Entire Object Structure</a></li>
<li class="chapter" data-level="7.3.4" data-path="feature-selection-and-cluster-analysis-1.html"><a href="feature-selection-and-cluster-analysis-1.html#practice-visualizingembedding"><i class="fa fa-check"></i><b>7.3.4</b> Practice Visualizing/Embedding</a></li>
</ul></li>
<li class="chapter" data-level="7.4" data-path="feature-selection-and-cluster-analysis-1.html"><a href="feature-selection-and-cluster-analysis-1.html#other-options-for-analysis"><i class="fa fa-check"></i><b>7.4</b> Other Options For Analysis</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="references.html"><a href="references.html"><i class="fa fa-check"></i>References</a></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">ANALYSIS OF SINGLE CELL RNA-SEQ DATA</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="the-following-examples-use-the-pbmc-3k-dataset" class="section level1">
<h1><span class="header-section-number">5</span> The following examples use the PBMC 3k dataset</h1>
<div class="sourceCode" id="cb25"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb25-1"><a href="the-following-examples-use-the-pbmc-3k-dataset.html#cb25-1"></a>seurat</span></code></pre></div>
<pre><code>## An object of class Seurat 
## 16145 features across 907 samples within 1 assay 
## Active assay: RNA (16145 features)</code></pre>
<div class="sourceCode" id="cb27"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb27-1"><a href="the-following-examples-use-the-pbmc-3k-dataset.html#cb27-1"></a><span class="co"># nrow and ncol provide the number of features and cells in the active assay, respectively</span></span>
<span id="cb27-2"><a href="the-following-examples-use-the-pbmc-3k-dataset.html#cb27-2"></a><span class="co"># dim provides both nrow and ncol at the same time</span></span>
<span id="cb27-3"><a href="the-following-examples-use-the-pbmc-3k-dataset.html#cb27-3"></a><span class="kw">dim</span>(<span class="dt">x =</span> seurat)</span></code></pre></div>
<pre><code>## [1] 16145   907</code></pre>
<div class="sourceCode" id="cb29"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb29-1"><a href="the-following-examples-use-the-pbmc-3k-dataset.html#cb29-1"></a><span class="co"># In addtion to rownames and colnames, one can use dimnames</span></span>
<span id="cb29-2"><a href="the-following-examples-use-the-pbmc-3k-dataset.html#cb29-2"></a><span class="co"># which provides a two-length list with both rownames and colnames</span></span>
<span id="cb29-3"><a href="the-following-examples-use-the-pbmc-3k-dataset.html#cb29-3"></a><span class="kw">head</span>(<span class="dt">x =</span> <span class="kw">rownames</span>(<span class="dt">x =</span> seurat))</span></code></pre></div>
<pre><code>## [1] &quot;FO538757.2&quot;    &quot;RP4-669L17.10&quot; &quot;RP11-206L10.9&quot; &quot;LINC00115&quot;     &quot;NOC2L&quot;        
## [6] &quot;KLHL17&quot;</code></pre>
<div class="sourceCode" id="cb31"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb31-1"><a href="the-following-examples-use-the-pbmc-3k-dataset.html#cb31-1"></a><span class="kw">head</span>(<span class="dt">x =</span> <span class="kw">colnames</span>(<span class="dt">x =</span> seurat))</span></code></pre></div>
<pre><code>## [1] &quot;AAACCTGAGCTAGTCT&quot; &quot;AAACCTGAGGGCACTA&quot; &quot;AAACCTGAGTACGTTC&quot; &quot;AAACCTGAGTCCGGTC&quot;
## [5] &quot;AAACCTGCACCAGGTC&quot; &quot;AAACCTGCACCTCGTT&quot;</code></pre>
<div class="sourceCode" id="cb33"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb33-1"><a href="the-following-examples-use-the-pbmc-3k-dataset.html#cb33-1"></a><span class="co"># A vector of names of associated objects can be had with the names function</span></span>
<span id="cb33-2"><a href="the-following-examples-use-the-pbmc-3k-dataset.html#cb33-2"></a><span class="co"># These can be passed to the double [[ extract operator to pull them from the Seurat object</span></span>
<span id="cb33-3"><a href="the-following-examples-use-the-pbmc-3k-dataset.html#cb33-3"></a><span class="kw">names</span>(<span class="dt">x =</span> seurat)</span></code></pre></div>
<pre><code>## [1] &quot;RNA&quot;</code></pre>
<p>You can also see a print out of the entire structure of the object by using the <code>str</code> commmand.</p>
<div class="sourceCode" id="cb35"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb35-1"><a href="the-following-examples-use-the-pbmc-3k-dataset.html#cb35-1"></a><span class="kw">str</span>(seurat)</span></code></pre></div>
<pre><code>## Formal class &#39;Seurat&#39; [package &quot;Seurat&quot;] with 12 slots
##   ..@ assays      :List of 1
##   .. ..$ RNA:Formal class &#39;Assay&#39; [package &quot;Seurat&quot;] with 8 slots
##   .. .. .. ..@ counts       :Formal class &#39;dgCMatrix&#39; [package &quot;Matrix&quot;] with 6 slots
##   .. .. .. .. .. ..@ i       : int [1:1775453] 15 29 78 80 83 103 116 133 139 145 ...
##   .. .. .. .. .. ..@ p       : int [1:908] 0 1184 2571 4354 5442 8058 13649 15834 17474 18574 ...
##   .. .. .. .. .. ..@ Dim     : int [1:2] 16145 907
##   .. .. .. .. .. ..@ Dimnames:List of 2
##   .. .. .. .. .. .. ..$ : chr [1:16145] &quot;FO538757.2&quot; &quot;RP4-669L17.10&quot; &quot;RP11-206L10.9&quot; &quot;LINC00115&quot; ...
##   .. .. .. .. .. .. ..$ : chr [1:907] &quot;AAACCTGAGCTAGTCT&quot; &quot;AAACCTGAGGGCACTA&quot; &quot;AAACCTGAGTACGTTC&quot; &quot;AAACCTGAGTCCGGTC&quot; ...
##   .. .. .. .. .. ..@ x       : num [1:1775453] 1 2 7 1 1 3 1 1 1 1 ...
##   .. .. .. .. .. ..@ factors : list()
##   .. .. .. ..@ data         :Formal class &#39;dgCMatrix&#39; [package &quot;Matrix&quot;] with 6 slots
##   .. .. .. .. .. ..@ i       : int [1:1775453] 15 29 78 80 83 103 116 133 139 145 ...
##   .. .. .. .. .. ..@ p       : int [1:908] 0 1184 2571 4354 5442 8058 13649 15834 17474 18574 ...
##   .. .. .. .. .. ..@ Dim     : int [1:2] 16145 907
##   .. .. .. .. .. ..@ Dimnames:List of 2
##   .. .. .. .. .. .. ..$ : chr [1:16145] &quot;FO538757.2&quot; &quot;RP4-669L17.10&quot; &quot;RP11-206L10.9&quot; &quot;LINC00115&quot; ...
##   .. .. .. .. .. .. ..$ : chr [1:907] &quot;AAACCTGAGCTAGTCT&quot; &quot;AAACCTGAGGGCACTA&quot; &quot;AAACCTGAGTACGTTC&quot; &quot;AAACCTGAGTCCGGTC&quot; ...
##   .. .. .. .. .. ..@ x       : num [1:1775453] 1 2 7 1 1 3 1 1 1 1 ...
##   .. .. .. .. .. ..@ factors : list()
##   .. .. .. ..@ scale.data   : num[0 , 0 ] 
##   .. .. .. ..@ key          : chr &quot;rna_&quot;
##   .. .. .. ..@ assay.orig   : NULL
##   .. .. .. ..@ var.features : logi(0) 
##   .. .. .. ..@ meta.features:&#39;data.frame&#39;:   16145 obs. of  0 variables
##   .. .. .. ..@ misc         : NULL
##   ..@ meta.data   :&#39;data.frame&#39;: 907 obs. of  3 variables:
##   .. ..$ orig.ident  : Factor w/ 1 level &quot;10X_NSCLC&quot;: 1 1 1 1 1 1 1 1 1 1 ...
##   .. ..$ nCount_RNA  : num [1:907] 3605 3828 6452 3071 9389 ...
##   .. ..$ nFeature_RNA: int [1:907] 1184 1387 1783 1088 2616 5591 2185 1640 1100 2715 ...
##   ..@ active.assay: chr &quot;RNA&quot;
##   ..@ active.ident: Factor w/ 1 level &quot;10X_NSCLC&quot;: 1 1 1 1 1 1 1 1 1 1 ...
##   .. ..- attr(*, &quot;names&quot;)= chr [1:907] &quot;AAACCTGAGCTAGTCT&quot; &quot;AAACCTGAGGGCACTA&quot; &quot;AAACCTGAGTACGTTC&quot; &quot;AAACCTGAGTCCGGTC&quot; ...
##   ..@ graphs      : list()
##   ..@ neighbors   : list()
##   ..@ reductions  : list()
##   ..@ project.name: chr &quot;10X_NSCLC&quot;
##   ..@ misc        : list()
##   ..@ version     :Classes &#39;package_version&#39;, &#39;numeric_version&#39;  hidden list of 1
##   .. ..$ : int [1:3] 3 1 2
##   ..@ commands    : list()
##   ..@ tools       : list()</code></pre>
<div id="data-access" class="section level4">
<h4><span class="header-section-number">5.0.0.1</span> Data Access</h4>
<p>Pulling specific Assay, DimReduc, or Graph objects can be done with the double [[ extract operator. Adding new objects to a Seurat object is also done with the double [[ extract operator; Seurat will figure out where in the Seurat object a new associated object belongs.</p>
<div class="sourceCode" id="cb37"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb37-1"><a href="the-following-examples-use-the-pbmc-3k-dataset.html#cb37-1"></a>seurat[[<span class="st">&#39;RNA&#39;</span>]]</span></code></pre></div>
<pre><code>## Assay data with 16145 features for 907 cells
## First 10 features:
##  FO538757.2, RP4-669L17.10, RP11-206L10.9, LINC00115, NOC2L, KLHL17, PLEKHN1, HES4,
## ISG15, AGRN</code></pre>
<p>Accessing data from an Seurat object is done with the GetAssayData function. Adding expression data to either the counts, data, or scale.data slots can be done with SetAssayData. New data must have the same cells in the same order as the current expression data. Data added to counts or data must have the same features as the current expression data.</p>
<div class="sourceCode" id="cb39"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb39-1"><a href="the-following-examples-use-the-pbmc-3k-dataset.html#cb39-1"></a><span class="co">## same as above but using object Method</span></span>
<span id="cb39-2"><a href="the-following-examples-use-the-pbmc-3k-dataset.html#cb39-2"></a><span class="kw">GetAssayData</span>(<span class="dt">object =</span> seurat, <span class="dt">slot =</span> <span class="st">&#39;data&#39;</span>)[<span class="dv">1</span><span class="op">:</span><span class="dv">10</span>, <span class="dv">1</span><span class="op">:</span><span class="dv">10</span>]</span></code></pre></div>
<pre><code>## 10 x 10 sparse Matrix of class &quot;dgCMatrix&quot;</code></pre>
<pre><code>##    [[ suppressing 10 column names &#39;AAACCTGAGCTAGTCT&#39;, &#39;AAACCTGAGGGCACTA&#39;, &#39;AAACCTGAGTACGTTC&#39; ... ]]</code></pre>
<pre><code>##                                  
## FO538757.2    . . . . 1 2 . . . .
## RP4-669L17.10 . . . . . . . . . .
## RP11-206L10.9 . . . . . . . . . .
## LINC00115     . . . . . . . . . .
## NOC2L         . . . . 2 4 . 1 . .
## KLHL17        . . . . . . . . . .
## PLEKHN1       . . . . . . . . . .
## HES4          . . . . . 9 . . . 1
## ISG15         . . . . 1 1 . . 1 .
## AGRN          . . . . . . . . . .</code></pre>
<p>Cell-level meta data can be accessed with the single [ extract operator or using the <code>$</code> sign. Pulling with the <code>$</code> sign means only one bit of meta data can be pulled at a time, though tab-autocompletion has been enabled for it, making it ideal for interactive use. Adding cell-level meta data can be set using the single [ extract operator as well, or by using AddMetaData.</p>
<div class="sourceCode" id="cb43"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb43-1"><a href="the-following-examples-use-the-pbmc-3k-dataset.html#cb43-1"></a><span class="co"># Cell-level meta data is stored as a data frame</span></span>
<span id="cb43-2"><a href="the-following-examples-use-the-pbmc-3k-dataset.html#cb43-2"></a><span class="co"># Standard data frame functions work on the meta data data frame</span></span>
<span id="cb43-3"><a href="the-following-examples-use-the-pbmc-3k-dataset.html#cb43-3"></a><span class="kw">colnames</span>(<span class="dt">x =</span> seurat[])</span></code></pre></div>
<pre><code>##   [1] &quot;AAACCTGAGCTAGTCT&quot; &quot;AAACCTGAGGGCACTA&quot; &quot;AAACCTGAGTACGTTC&quot; &quot;AAACCTGAGTCCGGTC&quot;
##   [5] &quot;AAACCTGCACCAGGTC&quot; &quot;AAACCTGCACCTCGTT&quot; &quot;AAACCTGCAGCTGTGC&quot; &quot;AAACCTGGTAAATGAC&quot;
##   [9] &quot;AAACCTGGTACTTAGC&quot; &quot;AAACCTGTCCTCAATT&quot; &quot;AAACCTGTCCTGCAGG&quot; &quot;AAACGGGAGCTTATCG&quot;
##  [13] &quot;AAACGGGAGGCCCTTG&quot; &quot;AAACGGGCAAGTAATG&quot; &quot;AAACGGGCACCAGATT&quot; &quot;AAACGGGGTAATCACC&quot;
##  [17] &quot;AAACGGGGTAGCTGCC&quot; &quot;AAACGGGGTGGTGTAG&quot; &quot;AAACGGGTCACCTCGT&quot; &quot;AAACGGGTCCCAAGTA&quot;
##  [21] &quot;AAAGATGAGAAACCTA&quot; &quot;AAAGATGAGACTTTCG&quot; &quot;AAAGATGAGATATGGT&quot; &quot;AAAGATGAGATCCGAG&quot;
##  [25] &quot;AAAGATGAGATGAGAG&quot; &quot;AAAGATGAGCCAGTAG&quot; &quot;AAAGATGCAATCCAAC&quot; &quot;AAAGATGCACGAAATA&quot;
##  [29] &quot;AAAGATGCACGTAAGG&quot; &quot;AAAGATGCAGAGTGTG&quot; &quot;AAAGATGCAGCCAGAA&quot; &quot;AAAGATGCAGGACCCT&quot;
##  [33] &quot;AAAGATGGTCATACTG&quot; &quot;AAAGATGGTCCGTGAC&quot; &quot;AAAGATGGTCGAAAGC&quot; &quot;AAAGATGGTGCCTGGT&quot;
##  [37] &quot;AAAGATGGTTACCGAT&quot; &quot;AAAGATGGTTGGTAAA&quot; &quot;AAAGATGTCAGCGATT&quot; &quot;AAAGATGTCCCAAGTA&quot;
##  [41] &quot;AAAGATGTCCGAATGT&quot; &quot;AAAGATGTCCTAGTGA&quot; &quot;AAAGATGTCGAACTGT&quot; &quot;AAAGATGTCTGTCTCG&quot;
##  [45] &quot;AAAGCAAAGAATTGTG&quot; &quot;AAAGCAAAGAGACGAA&quot; &quot;AAAGCAAAGAGTTGGC&quot; &quot;AAAGCAACAAGGTTCT&quot;
##  [49] &quot;AAAGCAACACGCCAGT&quot; &quot;AAAGCAAGTAGCTGCC&quot; &quot;AAAGCAAGTGCCTGTG&quot; &quot;AAAGCAAGTTAGTGGG&quot;
##  [53] &quot;AAAGCAATCACTATTC&quot; &quot;AAAGCAATCATCGGAT&quot; &quot;AAAGCAATCATCTGCC&quot; &quot;AAAGCAATCCTAGAAC&quot;
##  [57] &quot;AAAGCAATCGAACGGA&quot; &quot;AAAGCAATCGTACGGC&quot; &quot;AAAGCAATCTCAAGTG&quot; &quot;AAAGTAGAGAGTAATC&quot;
##  [61] &quot;AAAGTAGAGCCGATTT&quot; &quot;AAAGTAGAGGATTCGG&quot; &quot;AAAGTAGCAATGTAAG&quot; &quot;AAAGTAGCACGACTCG&quot;
##  [65] &quot;AAAGTAGGTAATTGGA&quot; &quot;AAAGTAGGTATCAGTC&quot; &quot;AAAGTAGGTCGCGAAA&quot; &quot;AAAGTAGGTGGTCCGT&quot;
##  [69] &quot;AAAGTAGGTTGCCTCT&quot; &quot;AAAGTAGTCAGGCAAG&quot; &quot;AAAGTAGTCCAAAGTC&quot; &quot;AAAGTAGTCTTGTCAT&quot;
##  [73] &quot;AAATGCCAGACGACGT&quot; &quot;AAATGCCAGGCAAAGA&quot; &quot;AAATGCCAGGGTGTTG&quot; &quot;AAATGCCAGGTAAACT&quot;
##  [77] &quot;AAATGCCCAATGTAAG&quot; &quot;AAATGCCCACACATGT&quot; &quot;AAATGCCCAGCTCGAC&quot; &quot;AAATGCCCATCTATGG&quot;
##  [81] &quot;AAATGCCGTACTTCTT&quot; &quot;AAATGCCGTCTTGCGG&quot; &quot;AAATGCCGTGTAACGG&quot; &quot;AAATGCCTCCAAACAC&quot;
##  [85] &quot;AAATGCCTCCGCGGTA&quot; &quot;AAATGCCTCGTCGTTC&quot; &quot;AACACGTAGCTAGTCT&quot; &quot;AACACGTAGGATTCGG&quot;
##  [89] &quot;AACACGTAGTACCGGA&quot; &quot;AACACGTCACAGAGGT&quot; &quot;AACACGTCACGACTCG&quot; &quot;AACACGTCAGTCAGCC&quot;
##  [93] &quot;AACACGTGTAATCGTC&quot; &quot;AACACGTGTACCAGTT&quot; &quot;AACACGTGTTGGGACA&quot; &quot;AACACGTTCACCACCT&quot;
##  [97] &quot;AACACGTTCACCGGGT&quot; &quot;AACACGTTCCAGAGGA&quot; &quot;AACACGTTCCTGCAGG&quot; &quot;AACACGTTCGCATGGC&quot;
## [101] &quot;AACACGTTCTTACCGC&quot; &quot;AACACGTTCTTGCATT&quot; &quot;AACCATGAGTAGTGCG&quot; &quot;AACCATGCAAAGGCGT&quot;
## [105] &quot;AACCATGCAAGCGAGT&quot; &quot;AACCATGCAGCATACT&quot; &quot;AACCATGCATGTTGAC&quot; &quot;AACCATGCATTCTCAT&quot;
## [109] &quot;AACCATGGTCCGAAGA&quot; &quot;AACCATGGTGCCTGCA&quot; &quot;AACCATGGTGTTGAGG&quot; &quot;AACCATGGTTGATTCG&quot;
## [113] &quot;AACCATGTCAATCTCT&quot; &quot;AACCATGTCCGAAGAG&quot; &quot;AACCATGTCTCCGGTT&quot; &quot;AACCGCGAGAGGTTGC&quot;
## [117] &quot;AACCGCGAGGGTCTCC&quot; &quot;AACCGCGCAAGGTGTG&quot; &quot;AACCGCGCAGGACGTA&quot; &quot;AACCGCGCAGGGTTAG&quot;
## [121] &quot;AACCGCGCAGTAACGG&quot; &quot;AACCGCGCATTCCTGC&quot; &quot;AACCGCGGTGACTCAT&quot; &quot;AACCGCGGTGGGTCAA&quot;
## [125] &quot;AACCGCGTCAATCTCT&quot; &quot;AACCGCGTCCTTGGTC&quot; &quot;AACCGCGTCGCACTCT&quot; &quot;AACCGCGTCGGCCGAT&quot;
## [129] &quot;AACCGCGTCTTGCCGT&quot; &quot;AACGTTGAGAACTCGG&quot; &quot;AACGTTGAGGGTGTGT&quot; &quot;AACGTTGCAGGTCGTC&quot;
## [133] &quot;AACGTTGCAGTCGTGC&quot; &quot;AACGTTGCATATACGC&quot; &quot;AACGTTGTCATACGGT&quot; &quot;AACGTTGTCCACGACG&quot;
## [137] &quot;AACGTTGTCCGTCATC&quot; &quot;AACGTTGTCTGGTATG&quot; &quot;AACTCAGAGACTAAGT&quot; &quot;AACTCAGAGCGTAATA&quot;
## [141] &quot;AACTCAGAGCGTCTAT&quot; &quot;AACTCAGAGCTGAAAT&quot; &quot;AACTCAGAGTGGACGT&quot; &quot;AACTCAGCACATAACC&quot;
## [145] &quot;AACTCAGGTGTTCGAT&quot; &quot;AACTCAGGTTCTCATT&quot; &quot;AACTCAGTCACCCTCA&quot; &quot;AACTCAGTCAGCCTAA&quot;
## [149] &quot;AACTCAGTCCTATGTT&quot; &quot;AACTCAGTCTAACCGA&quot; &quot;AACTCAGTCTCGTATT&quot; &quot;AACTCCCAGACAAGCC&quot;
## [153] &quot;AACTCCCAGACTAGGC&quot; &quot;AACTCCCAGGATCGCA&quot; &quot;AACTCCCAGGCAGGTT&quot; &quot;AACTCCCAGTACGTTC&quot;
## [157] &quot;AACTCCCAGTCGTTTG&quot; &quot;AACTCCCAGTGACTCT&quot; &quot;AACTCCCCACAAGTAA&quot; &quot;AACTCCCCACGCATCG&quot;
## [161] &quot;AACTCCCCAGTATCTG&quot; &quot;AACTCCCCATCCTAGA&quot; &quot;AACTCCCCATCGTCGG&quot; &quot;AACTCCCGTCGAACAG&quot;
## [165] &quot;AACTCCCGTGCACGAA&quot; &quot;AACTCCCGTTCACCTC&quot; &quot;AACTCCCTCAGTTTGG&quot; &quot;AACTCCCTCTGGTGTA&quot;
## [169] &quot;AACTCTTCAAGAAGAG&quot; &quot;AACTCTTCAAGTCTGT&quot; &quot;AACTCTTCAATGTTGC&quot; &quot;AACTCTTCATCTCCCA&quot;
## [173] &quot;AACTCTTCATTTCAGG&quot; &quot;AACTCTTGTGCGGTAA&quot; &quot;AACTCTTGTGTCCTCT&quot; &quot;AACTCTTGTTTGGGCC&quot;
## [177] &quot;AACTCTTTCAACGAAA&quot; &quot;AACTCTTTCCTTGCCA&quot; &quot;AACTCTTTCTCGTTTA&quot; &quot;AACTGGTAGAGGTACC&quot;
## [181] &quot;AACTGGTAGGGAAACA&quot; &quot;AACTGGTAGGTGTGGT&quot; &quot;AACTGGTAGTACGACG&quot; &quot;AACTGGTCAAACTGCT&quot;
## [185] &quot;AACTGGTCACGAGGTA&quot; &quot;AACTGGTGTACATGTC&quot; &quot;AACTGGTGTGGCAAAC&quot; &quot;AACTGGTGTTACCAGT&quot;
## [189] &quot;AACTGGTGTTGAGGTG&quot; &quot;AACTGGTGTTGGAGGT&quot; &quot;AACTGGTGTTTGACAC&quot; &quot;AACTGGTGTTTGTTTC&quot;
## [193] &quot;AACTGGTTCAATCACG&quot; &quot;AACTGGTTCACAAACC&quot; &quot;AACTGGTTCACCCGAG&quot; &quot;AACTGGTTCAGCACAT&quot;
## [197] &quot;AACTGGTTCCTTTACA&quot; &quot;AACTGGTTCGGGAGTA&quot; &quot;AACTGGTTCGTCACGG&quot; &quot;AACTGGTTCTCTTATG&quot;
## [201] &quot;AACTTTCAGGCAGTCA&quot; &quot;AACTTTCAGGTTACCT&quot; &quot;AACTTTCCACCAGGCT&quot; &quot;AACTTTCCAGGTGCCT&quot;
## [205] &quot;AACTTTCCATGAACCT&quot; &quot;AACTTTCCATGTAAGA&quot; &quot;AACTTTCCATGTCCTC&quot; &quot;AACTTTCGTAAGTGTA&quot;
## [209] &quot;AACTTTCGTACACCGC&quot; &quot;AACTTTCGTATAGGTA&quot; &quot;AACTTTCGTCTAGTCA&quot; &quot;AACTTTCGTTAAAGAC&quot;
## [213] &quot;AACTTTCGTTACGGAG&quot; &quot;AACTTTCGTTGTGGAG&quot; &quot;AACTTTCTCACTCCTG&quot; &quot;AACTTTCTCGAACTGT&quot;
## [217] &quot;AACTTTCTCGCAAACT&quot; &quot;AACTTTCTCTTGCAAG&quot; &quot;AAGACCTAGAGGTAGA&quot; &quot;AAGACCTAGGATATAC&quot;
## [221] &quot;AAGACCTAGGCTATCT&quot; &quot;AAGACCTAGTCCAGGA&quot; &quot;AAGACCTAGTCGTTTG&quot; &quot;AAGACCTAGTGACATA&quot;
## [225] &quot;AAGACCTCAAGCCTAT&quot; &quot;AAGACCTCAATGAATG&quot; &quot;AAGACCTCATACAGCT&quot; &quot;AAGACCTCATGGGAAC&quot;
## [229] &quot;AAGACCTCATTTGCCC&quot; &quot;AAGACCTGTAATAGCA&quot; &quot;AAGACCTGTAGCTAAA&quot; &quot;AAGACCTGTCCGAGTC&quot;
## [233] &quot;AAGACCTGTCTAGAGG&quot; &quot;AAGACCTGTGAAAGAG&quot; &quot;AAGACCTGTTGACGTT&quot; &quot;AAGACCTTCACCGTAA&quot;
## [237] &quot;AAGACCTTCCGGCACA&quot; &quot;AAGACCTTCTCCAGGG&quot; &quot;AAGCCGCAGAGTCGGT&quot; &quot;AAGCCGCAGCACGCCT&quot;
## [241] &quot;AAGCCGCAGCCAGGAT&quot; &quot;AAGCCGCAGCTGCGAA&quot; &quot;AAGCCGCCACGACGAA&quot; &quot;AAGCCGCCATGGTTGT&quot;
## [245] &quot;AAGCCGCCATTCCTCG&quot; &quot;AAGCCGCGTACGCACC&quot; &quot;AAGCCGCGTCCTCCAT&quot; &quot;AAGCCGCGTTACCAGT&quot;
## [249] &quot;AAGCCGCGTTGACGTT&quot; &quot;AAGCCGCTCATGCAAC&quot; &quot;AAGCCGCTCCAGAGGA&quot; &quot;AAGCCGCTCCTATTCA&quot;
## [253] &quot;AAGCCGCTCCTCCTAG&quot; &quot;AAGCCGCTCGGATGGA&quot; &quot;AAGCCGCTCGTAGGAG&quot; &quot;AAGCCGCTCTAACTGG&quot;
## [257] &quot;AAGGAGCAGATGGCGT&quot; &quot;AAGGAGCAGCCCAATT&quot; &quot;AAGGAGCAGCGGCTTC&quot; &quot;AAGGAGCAGGATATAC&quot;
## [261] &quot;AAGGAGCAGTAACCCT&quot; &quot;AAGGAGCCAGACGCTC&quot; &quot;AAGGAGCCAGACGTAG&quot; &quot;AAGGAGCCAGCCTATA&quot;
## [265] &quot;AAGGAGCGTCTCAACA&quot; &quot;AAGGAGCTCAATCACG&quot; &quot;AAGGAGCTCAGGCAAG&quot; &quot;AAGGAGCTCGGAAACG&quot;
## [269] &quot;AAGGAGCTCTAGCACA&quot; &quot;AAGGAGCTCTCAAACG&quot; &quot;AAGGAGCTCTTGAGAC&quot; &quot;AAGGCAGAGGATGGAA&quot;
## [273] &quot;AAGGCAGAGTGACATA&quot; &quot;AAGGCAGCAAGTAATG&quot; &quot;AAGGCAGCACACATGT&quot; &quot;AAGGCAGCACGAGGTA&quot;
## [277] &quot;AAGGCAGCATACTACG&quot; &quot;AAGGCAGCATCAGTAC&quot; &quot;AAGGCAGCATTCACTT&quot; &quot;AAGGCAGGTAGCCTAT&quot;
## [281] &quot;AAGGCAGGTGATGTGG&quot; &quot;AAGGCAGGTGTTTGGT&quot; &quot;AAGGCAGGTTGTGGCC&quot; &quot;AAGGCAGTCAATAAGG&quot;
## [285] &quot;AAGGCAGTCTGCTGTC&quot; &quot;AAGGTTCAGAACAATC&quot; &quot;AAGGTTCAGAATCTCC&quot; &quot;AAGGTTCAGCGTTGCC&quot;
## [289] &quot;AAGGTTCAGGCCGAAT&quot; &quot;AAGGTTCAGGCTATCT&quot; &quot;AAGGTTCAGGGTGTGT&quot; &quot;AAGGTTCAGTCAAGCG&quot;
## [293] &quot;AAGGTTCAGTTACCCA&quot; &quot;AAGGTTCCAACACCCG&quot; &quot;AAGGTTCCACAGCGTC&quot; &quot;AAGGTTCCACTAAGTC&quot;
## [297] &quot;AAGGTTCCACTTGGAT&quot; &quot;AAGGTTCCATAAGACA&quot; &quot;AAGGTTCCATCACAAC&quot; &quot;AAGGTTCCATCGGACC&quot;
## [301] &quot;AAGGTTCGTATAGTAG&quot; &quot;AAGGTTCGTGATGATA&quot; &quot;AAGGTTCGTTATGCGT&quot; &quot;AAGGTTCGTTCCGGCA&quot;
## [305] &quot;AAGGTTCTCCCTTGTG&quot; &quot;AAGTCTGAGATGTGGC&quot; &quot;AAGTCTGAGGATCGCA&quot; &quot;AAGTCTGCAAGCCGCT&quot;
## [309] &quot;AAGTCTGGTTCCTCCA&quot; &quot;AAGTCTGTCAACCATG&quot; &quot;AAGTCTGTCATAGCAC&quot; &quot;AAGTCTGTCCAAGCCG&quot;
## [313] &quot;AAGTCTGTCTAACTTC&quot; &quot;AATCCAGAGCTGATAA&quot; &quot;AATCCAGAGGCTCAGA&quot; &quot;AATCCAGAGGGATCTG&quot;
## [317] &quot;AATCCAGAGGTGTTAA&quot; &quot;AATCCAGCACATCTTT&quot; &quot;AATCCAGCACGAAACG&quot; &quot;AATCCAGCACGGATAG&quot;
## [321] &quot;AATCCAGCAGACGCTC&quot; &quot;AATCCAGGTCAGAGGT&quot; &quot;AATCCAGGTCGGCTCA&quot; &quot;AATCCAGGTTCCCGAG&quot;
## [325] &quot;AATCCAGGTTCGGGCT&quot; &quot;AATCCAGGTTGGTGGA&quot; &quot;AATCCAGTCAGAGCTT&quot; &quot;AATCCAGTCCATTCTA&quot;
## [329] &quot;AATCCAGTCCTGCAGG&quot; &quot;AATCGGTAGCCACGTC&quot; &quot;AATCGGTAGGGATACC&quot; &quot;AATCGGTCAACGCACC&quot;
## [333] &quot;AATCGGTCACCATCCT&quot; &quot;AATCGGTCAGCGAACA&quot; &quot;AATCGGTCATGTCCTC&quot; &quot;AATCGGTCATTATCTC&quot;
## [337] &quot;AATCGGTGTCGGATCC&quot; &quot;AATCGGTGTCTGGTCG&quot; &quot;AATCGGTGTTTGCATG&quot; &quot;AATCGGTTCAAACGGG&quot;
## [341] &quot;AATCGGTTCAACGCTA&quot; &quot;AATCGGTTCCACGCAG&quot; &quot;AATCGGTTCCCGGATG&quot; &quot;AATCGGTTCGTGGACC&quot;
## [345] &quot;AATCGGTTCTACCAGA&quot; &quot;AATCGGTTCTAGCACA&quot; &quot;ACACCAAAGCGATATA&quot; &quot;ACACCAAAGCTCCCAG&quot;
## [349] &quot;ACACCAAAGTGGTAGC&quot; &quot;ACACCAAAGTGTCCAT&quot; &quot;ACACCAACAAGTCATC&quot; &quot;ACACCAACACACGCTG&quot;
## [353] &quot;ACACCAACACAGCCCA&quot; &quot;ACACCAACAGGTCTCG&quot; &quot;ACACCAACATCGGAAG&quot; &quot;ACACCAAGTCAAACTC&quot;
## [357] &quot;ACACCAAGTCGGCTCA&quot; &quot;ACACCAAGTCTGGTCG&quot; &quot;ACACCAAGTGACAAAT&quot; &quot;ACACCAAGTGCTTCTC&quot;
## [361] &quot;ACACCAAGTGGACGAT&quot; &quot;ACACCAATCATCGGAT&quot; &quot;ACACCAATCCGTAGTA&quot; &quot;ACACCAATCGTCTGAA&quot;
## [365] &quot;ACACCAATCGTTGCCT&quot; &quot;ACACCCTAGACCTAGG&quot; &quot;ACACCCTAGCCAGTAG&quot; &quot;ACACCCTAGTAGCGGT&quot;
## [369] &quot;ACACCCTCAACTGCTA&quot; &quot;ACACCCTCAGCCAGAA&quot; &quot;ACACCCTCATCGGTTA&quot; &quot;ACACCCTCATGCCACG&quot;
## [373] &quot;ACACCCTCATGTCGAT&quot; &quot;ACACCCTCATTATCTC&quot; &quot;ACACCCTGTAGGACAC&quot; &quot;ACACCCTTCAAACAAG&quot;
## [377] &quot;ACACCCTTCATATCGG&quot; &quot;ACACCCTTCATTATCC&quot; &quot;ACACCCTTCCAGGGCT&quot; &quot;ACACCCTTCCCTAATT&quot;
## [381] &quot;ACACCCTTCCGTTGCT&quot; &quot;ACACCCTTCGCGCCAA&quot; &quot;ACACCCTTCGTAGGTT&quot; &quot;ACACCCTTCGTTACGA&quot;
## [385] &quot;ACACCCTTCTGGGCCA&quot; &quot;ACACCGGAGAGCTATA&quot; &quot;ACACCGGAGCACCGCT&quot; &quot;ACACCGGAGGCATGGT&quot;
## [389] &quot;ACACCGGAGGCTATCT&quot; &quot;ACACCGGAGTCATCCA&quot; &quot;ACACCGGAGTGAAGAG&quot; &quot;ACACCGGAGTGGGATC&quot;
## [393] &quot;ACACCGGCAAGCCGTC&quot; &quot;ACACCGGCAGGTCTCG&quot; &quot;ACACCGGGTGACTACT&quot; &quot;ACACCGGGTTCGCTAA&quot;
## [397] &quot;ACACCGGTCGCCTGTT&quot; &quot;ACACCGGTCTTAGAGC&quot; &quot;ACACTGAAGACAGACC&quot; &quot;ACACTGAAGTACTTGC&quot;
## [401] &quot;ACACTGAAGTCTTGCA&quot; &quot;ACACTGACAACTGCGC&quot; &quot;ACACTGACAAGAGGCT&quot; &quot;ACACTGACAAGCCGCT&quot;
## [405] &quot;ACACTGACACCCAGTG&quot; &quot;ACACTGACACTCAGGC&quot; &quot;ACACTGAGTACACCGC&quot; &quot;ACACTGAGTAGGGTAC&quot;
## [409] &quot;ACACTGAGTCGCATAT&quot; &quot;ACACTGAGTCTCTCTG&quot; &quot;ACACTGAGTGGCAAAC&quot; &quot;ACACTGAGTGTCCTCT&quot;
## [413] &quot;ACACTGAGTTGAGTTC&quot; &quot;ACACTGATCAGTGCAT&quot; &quot;ACAGCCGAGACCACGA&quot; &quot;ACAGCCGAGACTAGGC&quot;
## [417] &quot;ACAGCCGAGCTACCGC&quot; &quot;ACAGCCGAGTTCGCGC&quot; &quot;ACAGCCGCAACGATCT&quot; &quot;ACAGCCGCACCAGGTC&quot;
## [421] &quot;ACAGCCGCACCATCCT&quot; &quot;ACAGCCGCATGGGACA&quot; &quot;ACAGCCGGTACCGGCT&quot; &quot;ACAGCCGGTAGCGTAG&quot;
## [425] &quot;ACAGCCGGTTCAGGCC&quot; &quot;ACAGCCGGTTCCACTC&quot; &quot;ACAGCCGGTTTCGCTC&quot; &quot;ACAGCCGTCAGGCCCA&quot;
## [429] &quot;ACAGCCGTCCCATTAT&quot; &quot;ACAGCCGTCGTGGACC&quot; &quot;ACAGCCGTCTGATTCT&quot; &quot;ACAGCTAAGATGGCGT&quot;
## [433] &quot;ACAGCTAAGCGTAGTG&quot; &quot;ACAGCTACAATAGCAA&quot; &quot;ACAGCTATCACATGCA&quot; &quot;ACAGCTATCCAACCAA&quot;
## [437] &quot;ACAGCTATCGTAGGAG&quot; &quot;ACAGCTATCTCGGACG&quot; &quot;ACATACGAGAATTGTG&quot; &quot;ACATACGAGAGTCTGG&quot;
## [441] &quot;ACATACGCAAGCCGTC&quot; &quot;ACATACGCAGACGTAG&quot; &quot;ACATACGCATCGGACC&quot; &quot;ACATACGGTCATTAGC&quot;
## [445] &quot;ACATACGGTCGGCACT&quot; &quot;ACATACGGTCTAGTCA&quot; &quot;ACATACGTCATGCTCC&quot; &quot;ACATCAGAGTCCCACG&quot;
## [449] &quot;ACATCAGAGTTATCGC&quot; &quot;ACATCAGCACACCGCA&quot; &quot;ACATCAGCACAGTCGC&quot; &quot;ACATCAGCACGCGAAA&quot;
## [453] &quot;ACATCAGCATCCCACT&quot; &quot;ACATCAGCATTCTTAC&quot; &quot;ACATCAGCATTTGCTT&quot; &quot;ACATCAGGTCGAACAG&quot;
## [457] &quot;ACATCAGGTCTCGTTC&quot; &quot;ACATCAGGTGAAAGAG&quot; &quot;ACATCAGGTGCATCTA&quot; &quot;ACATCAGTCACCGTAA&quot;
## [461] &quot;ACATCAGTCAGTCAGT&quot; &quot;ACATCAGTCGAACGGA&quot; &quot;ACATCAGTCGACAGCC&quot; &quot;ACATCAGTCGCACTCT&quot;
## [465] &quot;ACATCAGTCTTTACGT&quot; &quot;ACATGGTAGACTTGAA&quot; &quot;ACATGGTAGTAGTGCG&quot; &quot;ACATGGTCAAAGCGGT&quot;
## [469] &quot;ACATGGTCAATAAGCA&quot; &quot;ACATGGTCAATGAATG&quot; &quot;ACATGGTCATGCAATC&quot; &quot;ACATGGTCATGGTCAT&quot;
## [473] &quot;ACATGGTGTGTGCCTG&quot; &quot;ACATGGTGTTGATTCG&quot; &quot;ACATGGTTCAATCTCT&quot; &quot;ACATGGTTCCGCGTTT&quot;
## [477] &quot;ACATGGTTCCTAAGTG&quot; &quot;ACATGGTTCGTACGGC&quot; &quot;ACATGGTTCGTTTATC&quot; &quot;ACATGGTTCTACTATC&quot;
## [481] &quot;ACATGGTTCTGCCAGG&quot; &quot;ACCAGTAAGAGAGCTC&quot; &quot;ACCAGTACACGGTGTC&quot; &quot;ACCAGTACATGCAATC&quot;
## [485] &quot;ACCAGTAGTCTCTCGT&quot; &quot;ACCAGTAGTGCCTGCA&quot; &quot;ACCAGTAGTTCCCGAG&quot; &quot;ACCAGTAGTTTGGCGC&quot;
## [489] &quot;ACCAGTATCCAATGGT&quot; &quot;ACCAGTATCCATGAAC&quot; &quot;ACCCACTAGAATTCCC&quot; &quot;ACCCACTAGCGGATCA&quot;
## [493] &quot;ACCCACTAGCTCCTCT&quot; &quot;ACCCACTAGGCTCATT&quot; &quot;ACCCACTCAAAGCAAT&quot; &quot;ACCCACTCAACACCCG&quot;
## [497] &quot;ACCCACTCAGATCGGA&quot; &quot;ACCCACTCATGGTAGG&quot; &quot;ACCCACTGTCATTAGC&quot; &quot;ACCCACTGTCCTCTTG&quot;
## [501] &quot;ACCCACTGTCTCTTAT&quot; &quot;ACCCACTGTGGCAAAC&quot; &quot;ACCCACTGTTCCGGCA&quot; &quot;ACCCACTGTTGTTTGG&quot;
## [505] &quot;ACCCACTTCCTTGACC&quot; &quot;ACCCACTTCGGTGTTA&quot; &quot;ACCGTAAAGAGTGAGA&quot; &quot;ACCGTAAAGGTAAACT&quot;
## [509] &quot;ACCGTAACACACGCTG&quot; &quot;ACCGTAACAGCTCGAC&quot; &quot;ACCGTAACAGCTGTAT&quot; &quot;ACCGTAACATCCTAGA&quot;
## [513] &quot;ACCGTAACATGGGAAC&quot; &quot;ACCGTAACATTTCAGG&quot; &quot;ACCGTAAGTTCGCGAC&quot; &quot;ACCGTAATCCTATGTT&quot;
## [517] &quot;ACCGTAATCGGTGTTA&quot; &quot;ACCGTAATCGTCACGG&quot; &quot;ACCGTAATCTGGCGTG&quot; &quot;ACCTTTAAGAGCTTCT&quot;
## [521] &quot;ACCTTTAAGTTGTCGT&quot; &quot;ACCTTTACAAGCCCAC&quot; &quot;ACCTTTACATGTCCTC&quot; &quot;ACCTTTAGTAGAGTGC&quot;
## [525] &quot;ACCTTTATCATCTGTT&quot; &quot;ACCTTTATCCCTCTTT&quot; &quot;ACCTTTATCCCTGACT&quot; &quot;ACCTTTATCCTGTAGA&quot;
## [529] &quot;ACCTTTATCGCCAGCA&quot; &quot;ACCTTTATCTGCCCTA&quot; &quot;ACCTTTATCTTGACGA&quot; &quot;ACGAGCCAGAGCCTAG&quot;
## [533] &quot;ACGAGCCAGGTGATAT&quot; &quot;ACGAGCCCAAGCCGCT&quot; &quot;ACGAGCCCAGGCAGTA&quot; &quot;ACGAGCCGTACCGCTG&quot;
## [537] &quot;ACGAGCCGTAGAAAGG&quot; &quot;ACGAGCCGTTGTCGCG&quot; &quot;ACGAGCCGTTTCGCTC&quot; &quot;ACGAGCCTCACTTCAT&quot;
## [541] &quot;ACGAGCCTCCGTAGGC&quot; &quot;ACGAGCCTCGTCTGAA&quot; &quot;ACGAGCCTCGTGGACC&quot; &quot;ACGAGCCTCTTCATGT&quot;
## [545] &quot;ACGAGGAAGAAGAAGC&quot; &quot;ACGAGGAAGGTGATTA&quot; &quot;ACGAGGACACATAACC&quot; &quot;ACGAGGACATGGATGG&quot;
## [549] &quot;ACGAGGAGTTATCACG&quot; &quot;ACGAGGAGTTCGTTGA&quot; &quot;ACGAGGATCCAGGGCT&quot; &quot;ACGAGGATCCCTGACT&quot;
## [553] &quot;ACGAGGATCGAACTGT&quot; &quot;ACGATACAGAAAGTGG&quot; &quot;ACGATACAGACCTAGG&quot; &quot;ACGATACAGACTAGAT&quot;
## [557] &quot;ACGATACCAAACAACA&quot; &quot;ACGATACCAAGCTGGA&quot; &quot;ACGATACCACAGGCCT&quot; &quot;ACGATACCAGCCTATA&quot;
## [561] &quot;ACGATACGTATATCCG&quot; &quot;ACGATACGTCAATACC&quot; &quot;ACGATACGTCTTCTCG&quot; &quot;ACGATACGTGCCTTGG&quot;
## [565] &quot;ACGATACGTGCGATAG&quot; &quot;ACGATACGTGGAAAGA&quot; &quot;ACGATACGTTCCAACA&quot; &quot;ACGATACTCACATGCA&quot;
## [569] &quot;ACGATACTCAGCGATT&quot; &quot;ACGATACTCCCAGGTG&quot; &quot;ACGATGTAGAGGTACC&quot; &quot;ACGATGTAGATATGCA&quot;
## [573] &quot;ACGATGTCAAGCGTAG&quot; &quot;ACGATGTCAATAGCAA&quot; &quot;ACGATGTCACCAACCG&quot; &quot;ACGATGTCAGGAACGT&quot;
## [577] &quot;ACGATGTCATGTCGAT&quot; &quot;ACGATGTGTAGTAGTA&quot; &quot;ACGATGTGTGACTACT&quot; &quot;ACGATGTGTGCACTTA&quot;
## [581] &quot;ACGATGTGTGCCTGGT&quot; &quot;ACGATGTGTGGTACAG&quot; &quot;ACGATGTGTTCAGGCC&quot; &quot;ACGATGTTCCACGAAT&quot;
## [585] &quot;ACGATGTTCGGTCTAA&quot; &quot;ACGATGTTCGTCCGTT&quot; &quot;ACGATGTTCGTTTATC&quot; &quot;ACGATGTTCTCGCTTG&quot;
## [589] &quot;ACGATGTTCTGACCTC&quot; &quot;ACGATGTTCTGTCAAG&quot; &quot;ACGATGTTCTTACCGC&quot; &quot;ACGCAGCAGATCTGAA&quot;
## [593] &quot;ACGCAGCAGATGTGGC&quot; &quot;ACGCAGCAGTGTCTCA&quot; &quot;ACGCAGCCAACGATGG&quot; &quot;ACGCAGCCACACGCTG&quot;
## [597] &quot;ACGCAGCCAGCTGTTA&quot; &quot;ACGCAGCCAGGGTTAG&quot; &quot;ACGCAGCGTACTCAAC&quot; &quot;ACGCAGCGTAGGAGTC&quot;
## [601] &quot;ACGCAGCGTATATCCG&quot; &quot;ACGCAGCGTCACCTAA&quot; &quot;ACGCAGCGTCCTCCAT&quot; &quot;ACGCAGCGTCTTCTCG&quot;
## [605] &quot;ACGCAGCGTGTGGTTT&quot; &quot;ACGCAGCGTTCCTCCA&quot; &quot;ACGCAGCGTTGTCTTT&quot; &quot;ACGCAGCTCAGGATCT&quot;
## [609] &quot;ACGCAGCTCGACGGAA&quot; &quot;ACGCAGCTCGCCAAAT&quot; &quot;ACGCAGCTCTGATACG&quot; &quot;ACGCCAGAGAACAACT&quot;
## [613] &quot;ACGCCAGAGATGGGTC&quot; &quot;ACGCCAGAGATGTAAC&quot; &quot;ACGCCAGAGCACACAG&quot; &quot;ACGCCAGAGGATGTAT&quot;
## [617] &quot;ACGCCAGAGTAGGTGC&quot; &quot;ACGCCAGAGTCAAGCG&quot; &quot;ACGCCAGAGTCTCAAC&quot; &quot;ACGCCAGCAATGCCAT&quot;
## [621] &quot;ACGCCAGCACACCGCA&quot; &quot;ACGCCAGCACGTGAGA&quot; &quot;ACGCCAGCAGCGTCCA&quot; &quot;ACGCCAGGTCAATGTC&quot;
## [625] &quot;ACGCCAGGTCCGAGTC&quot; &quot;ACGCCAGGTCGACTAT&quot; &quot;ACGCCAGGTTCGCTAA&quot; &quot;ACGCCAGTCACTCCTG&quot;
## [629] &quot;ACGCCAGTCAGAGCTT&quot; &quot;ACGCCAGTCATATCGG&quot; &quot;ACGCCAGTCCCACTTG&quot; &quot;ACGCCAGTCCTGCCAT&quot;
## [633] &quot;ACGCCAGTCCTTTCGG&quot; &quot;ACGCCAGTCGCAGGCT&quot; &quot;ACGCCAGTCGTTTATC&quot; &quot;ACGCCGAAGACTAGGC&quot;
## [637] &quot;ACGCCGAAGAGGTTAT&quot; &quot;ACGCCGAAGTGTTAGA&quot; &quot;ACGCCGAAGTTACGGG&quot; &quot;ACGCCGACAATGTAAG&quot;
## [641] &quot;ACGCCGACAGACGCCT&quot; &quot;ACGCCGACAGGTTTCA&quot; &quot;ACGCCGACATCGGTTA&quot; &quot;ACGCCGAGTCTAACGT&quot;
## [645] &quot;ACGCCGAGTCTCTTTA&quot; &quot;ACGCCGAGTCTTCTCG&quot; &quot;ACGCCGAGTGTAATGA&quot; &quot;ACGCCGAGTTGCGCAC&quot;
## [649] &quot;ACGCCGATCAGGTAAA&quot; &quot;ACGCCGATCATGGTCA&quot; &quot;ACGCCGATCCTACAGA&quot; &quot;ACGCCGATCTCGATGA&quot;
## [653] &quot;ACGCCGATCTTAGAGC&quot; &quot;ACGCCGATCTTCAACT&quot; &quot;ACGGAGAAGAGGACGG&quot; &quot;ACGGAGAAGTTCGCGC&quot;
## [657] &quot;ACGGAGACAAGTTAAG&quot; &quot;ACGGAGACAAGTTCTG&quot; &quot;ACGGAGACAATCTACG&quot; &quot;ACGGAGACAGACTCGC&quot;
## [661] &quot;ACGGAGAGTACACCGC&quot; &quot;ACGGAGAGTACTTGAC&quot; &quot;ACGGAGAGTGCTCTTC&quot; &quot;ACGGAGAGTGGGTCAA&quot;
## [665] &quot;ACGGAGAGTGTGACGA&quot; &quot;ACGGAGAGTTCCCGAG&quot; &quot;ACGGAGAGTTCGGCAC&quot; &quot;ACGGAGATCAAACAAG&quot;
## [669] &quot;ACGGAGATCACATACG&quot; &quot;ACGGAGATCAGCGACC&quot; &quot;ACGGAGATCATCTGCC&quot; &quot;ACGGAGATCGAACGGA&quot;
## [673] &quot;ACGGCCAAGACCTAGG&quot; &quot;ACGGCCAAGCGAAGGG&quot; &quot;ACGGCCAAGCTGAAAT&quot; &quot;ACGGCCAAGGATCGCA&quot;
## [677] &quot;ACGGCCACAACGATCT&quot; &quot;ACGGCCACACACTGCG&quot; &quot;ACGGCCACACGAGAGT&quot; &quot;ACGGCCACACGGATAG&quot;
## [681] &quot;ACGGCCACACTCTGTC&quot; &quot;ACGGCCACAGTAAGAT&quot; &quot;ACGGCCAGTCAACATC&quot; &quot;ACGGCCAGTGAGTGAC&quot;
## [685] &quot;ACGGCCATCACTTATC&quot; &quot;ACGGCCATCATAAAGG&quot; &quot;ACGGCCATCCAAAGTC&quot; &quot;ACGGCCATCCGAGCCA&quot;
## [689] &quot;ACGGCCATCGGAATCT&quot; &quot;ACGGCCATCGTCACGG&quot; &quot;ACGGCCATCTGCCCTA&quot; &quot;ACGGGCTAGCCCAACC&quot;
## [693] &quot;ACGGGCTAGGGTATCG&quot; &quot;ACGGGCTAGGGTGTTG&quot; &quot;ACGGGCTCACACCGAC&quot; &quot;ACGGGCTCACCCATTC&quot;
## [697] &quot;ACGGGCTCATGTAGTC&quot; &quot;ACGGGCTCATGTCGAT&quot; &quot;ACGGGCTGTTCAACCA&quot; &quot;ACGGGCTTCAACCAAC&quot;
## [701] &quot;ACGGGCTTCAACCATG&quot; &quot;ACGGGCTTCTCTTGAT&quot; &quot;ACGGGTCAGATGCCAG&quot; &quot;ACGGGTCAGCACACAG&quot;
## [705] &quot;ACGGGTCCAGCTGTGC&quot; &quot;ACGGGTCGTATAGGTA&quot; &quot;ACGGGTCGTTGGAGGT&quot; &quot;ACGGGTCTCATGCATG&quot;
## [709] &quot;ACGGGTCTCATGGTCA&quot; &quot;ACGGGTCTCTCAAACG&quot; &quot;ACGGGTCTCTGGCGTG&quot; &quot;ACGTCAAAGCAATCTC&quot;
## [713] &quot;ACGTCAAAGTCTTGCA&quot; &quot;ACGTCAAAGTGGGTTG&quot; &quot;ACGTCAACAATCGGTT&quot; &quot;ACGTCAAGTCGAATCT&quot;
## [717] &quot;ACGTCAAGTGAGTGAC&quot; &quot;ACGTCAAGTGCACCAC&quot; &quot;ACGTCAATCACGAAGG&quot; &quot;ACGTCAATCAGTGCAT&quot;
## [721] &quot;ACGTCAATCAGTTGAC&quot; &quot;ACGTCAATCATCGGAT&quot; &quot;ACGTCAATCCAAAGTC&quot; &quot;ACGTCAATCCGAAGAG&quot;
## [725] &quot;ACGTCAATCTAACTTC&quot; &quot;ACGTCAATCTGATACG&quot; &quot;ACGTCAATCTGCCCTA&quot; &quot;ACTATCTAGCAACGGT&quot;
## [729] &quot;ACTATCTAGTAGCGGT&quot; &quot;ACTATCTCAATGCCAT&quot; &quot;ACTATCTCAGATAATG&quot; &quot;ACTATCTCATAGACTC&quot;
## [733] &quot;ACTATCTCATTCGACA&quot; &quot;ACTATCTGTGTAATGA&quot; &quot;ACTATCTGTTGGTGGA&quot; &quot;ACTATCTTCACGCATA&quot;
## [737] &quot;ACTATCTTCAGCACAT&quot; &quot;ACTATCTTCATGTCTT&quot; &quot;ACTGAACAGAAGGACA&quot; &quot;ACTGAACAGGGTCTCC&quot;
## [741] &quot;ACTGAACCAATGAAAC&quot; &quot;ACTGAACCACGCCAGT&quot; &quot;ACTGAACCACTTCTGC&quot; &quot;ACTGAACCAGCTGCAC&quot;
## [745] &quot;ACTGAACCAGGCTCAC&quot; &quot;ACTGAACGTACTTAGC&quot; &quot;ACTGAACGTATGGTTC&quot; &quot;ACTGAACGTTCGCGAC&quot;
## [749] &quot;ACTGAACGTTTGCATG&quot; &quot;ACTGAACTCACAAACC&quot; &quot;ACTGAACTCCATGCTC&quot; &quot;ACTGAGTAGAAGAAGC&quot;
## [753] &quot;ACTGAGTAGCACCGCT&quot; &quot;ACTGAGTAGGAGTACC&quot; &quot;ACTGAGTAGGCATGGT&quot; &quot;ACTGAGTCAACTGGCC&quot;
## [757] &quot;ACTGAGTCACACCGAC&quot; &quot;ACTGAGTCATAGAAAC&quot; &quot;ACTGAGTCATATGGTC&quot; &quot;ACTGAGTCATCCGTGG&quot;
## [761] &quot;ACTGAGTGTCAACTGT&quot; &quot;ACTGAGTGTCAGAAGC&quot; &quot;ACTGAGTGTGGACGAT&quot; &quot;ACTGAGTGTGTGACCC&quot;
## [765] &quot;ACTGAGTTCGGTCCGA&quot; &quot;ACTGATGAGAAACGAG&quot; &quot;ACTGATGAGACAAGCC&quot; &quot;ACTGATGAGCGATGAC&quot;
## [769] &quot;ACTGATGAGGTAAACT&quot; &quot;ACTGATGAGTAACCCT&quot; &quot;ACTGATGCACTCGACG&quot; &quot;ACTGATGCAGGTCTCG&quot;
## [773] &quot;ACTGATGGTCTCTCGT&quot; &quot;ACTGATGGTTCACCTC&quot; &quot;ACTGATGGTTCTGAAC&quot; &quot;ACTGATGTCCAGGGCT&quot;
## [777] &quot;ACTGATGTCCGCGGTA&quot; &quot;ACTGATGTCTCGCATC&quot; &quot;ACTGCTCAGTTACGGG&quot; &quot;ACTGCTCCAAACTGTC&quot;
## [781] &quot;ACTGCTCCAAGTTCTG&quot; &quot;ACTGCTCCACCTCGTT&quot; &quot;ACTGCTCCACTTGGAT&quot; &quot;ACTGCTCCAGCAGTTT&quot;
## [785] &quot;ACTGCTCGTGGTCCGT&quot; &quot;ACTGCTCTCAGAGGTG&quot; &quot;ACTGCTCTCCCGGATG&quot; &quot;ACTGCTCTCCGCGCAA&quot;
## [789] &quot;ACTGCTCTCTGAGTGT&quot; &quot;ACTGTCCAGACAGACC&quot; &quot;ACTGTCCAGAGATGAG&quot; &quot;ACTGTCCAGGGAACGG&quot;
## [793] &quot;ACTGTCCAGTTGTCGT&quot; &quot;ACTGTCCCACCTATCC&quot; &quot;ACTGTCCCAGCATGAG&quot; &quot;ACTGTCCGTCAGCTAT&quot;
## [797] &quot;ACTGTCCGTCCGTGAC&quot; &quot;ACTGTCCTCATTGCCC&quot; &quot;ACTGTCCTCGAACTGT&quot; &quot;ACTGTCCTCTAACTGG&quot;
## [801] &quot;ACTTACTAGAGGTAGA&quot; &quot;ACTTACTAGTCTTGCA&quot; &quot;ACTTACTAGTGTCCAT&quot; &quot;ACTTACTCAAGCTGAG&quot;
## [805] &quot;ACTTACTCACATCCAA&quot; &quot;ACTTACTCACGGTAAG&quot; &quot;ACTTACTGTAAACGCG&quot; &quot;ACTTACTGTAGCCTAT&quot;
## [809] &quot;ACTTACTGTCAAAGAT&quot; &quot;ACTTACTGTTTGACAC&quot; &quot;ACTTACTTCACAGTAC&quot; &quot;ACTTACTTCAGGCGAA&quot;
## [813] &quot;ACTTACTTCATCACCC&quot; &quot;ACTTGTTAGCGCTCCA&quot; &quot;ACTTGTTAGGCACATG&quot; &quot;ACTTGTTAGGTGCAAC&quot;
## [817] &quot;ACTTGTTCAATGGTCT&quot; &quot;ACTTGTTCACGCTTTC&quot; &quot;ACTTGTTCACGTCTCT&quot; &quot;ACTTGTTCAGACGCTC&quot;
## [821] &quot;ACTTGTTCAGTCAGAG&quot; &quot;ACTTGTTCATCCCACT&quot; &quot;ACTTGTTCATCCCATC&quot; &quot;ACTTGTTCATGAACCT&quot;
## [825] &quot;ACTTGTTGTCCGAGTC&quot; &quot;ACTTGTTGTCGAATCT&quot; &quot;ACTTGTTGTCGAGATG&quot; &quot;ACTTGTTGTCTCTCTG&quot;
## [829] &quot;ACTTGTTGTGCTGTAT&quot; &quot;ACTTGTTGTTGGGACA&quot; &quot;ACTTGTTGTTGTCTTT&quot; &quot;ACTTGTTTCCACTCCA&quot;
## [833] &quot;ACTTTCAAGCAGCGTA&quot; &quot;ACTTTCAAGCGTTTAC&quot; &quot;ACTTTCAAGCTAGGCA&quot; &quot;ACTTTCAAGCTCCTTC&quot;
## [837] &quot;ACTTTCACAAACGCGA&quot; &quot;ACTTTCACAGACTCGC&quot; &quot;ACTTTCACAGTCAGCC&quot; &quot;ACTTTCACATTGTGCA&quot;
## [841] &quot;ACTTTCAGTACTTAGC&quot; &quot;ACTTTCAGTACTTCTT&quot; &quot;ACTTTCAGTCTAAACC&quot; &quot;ACTTTCAGTGTAACGG&quot;
## [845] &quot;ACTTTCATCAACACGT&quot; &quot;ACTTTCATCCACGTTC&quot; &quot;AGAATAGAGATGTTAG&quot; &quot;AGAATAGAGCCAGGAT&quot;
## [849] &quot;AGAATAGAGCTCAACT&quot; &quot;AGAATAGAGGAGTACC&quot; &quot;AGAATAGAGGTAAACT&quot; &quot;AGAATAGAGGTCGGAT&quot;
## [853] &quot;AGAATAGAGTGGGTTG&quot; &quot;AGAATAGCAACGCACC&quot; &quot;AGAATAGCAAGGTGTG&quot; &quot;AGAATAGCACATGACT&quot;
## [857] &quot;AGAATAGCACCCAGTG&quot; &quot;AGAATAGCATAAAGGT&quot; &quot;AGAATAGCATAGAAAC&quot; &quot;AGAATAGCATGCCTTC&quot;
## [861] &quot;AGAATAGGTACTTAGC&quot; &quot;AGAATAGGTTCAGACT&quot; &quot;AGAATAGTCACCTCGT&quot; &quot;AGAATAGTCAGCTCTC&quot;
## [865] &quot;AGAATAGTCCTATTCA&quot; &quot;AGACGTTAGACTGGGT&quot; &quot;AGACGTTAGGCCCTCA&quot; &quot;AGACGTTAGGTAAACT&quot;
## [869] &quot;AGACGTTAGTGTTTGC&quot; &quot;AGACGTTCAGCTCCGA&quot; &quot;AGACGTTGTAGGACAC&quot; &quot;AGACGTTGTGGTACAG&quot;
## [873] &quot;AGACGTTTCAGTTAGC&quot; &quot;AGACGTTTCCGTACAA&quot; &quot;AGACGTTTCTGCAAGT&quot; &quot;AGACGTTTCTTCCTTC&quot;
## [877] &quot;AGAGCGAAGATCCCGC&quot; &quot;AGAGCGAAGATCCTGT&quot; &quot;AGAGCGAAGCAGATCG&quot; &quot;AGAGCGAAGTCCGGTC&quot;
## [881] &quot;AGAGCGACAAAGCAAT&quot; &quot;AGAGCGACAATGGAAT&quot; &quot;AGAGCGACATATGCTG&quot; &quot;AGAGCGACATCACAAC&quot;
## [885] &quot;AGAGCGACATGGAATA&quot; &quot;AGAGCGAGTACGACCC&quot; &quot;AGAGCGAGTCATGCAT&quot; &quot;AGAGCGAGTTGTACAC&quot;
## [889] &quot;AGAGCGATCACCGTAA&quot; &quot;AGAGCGATCAGCTTAG&quot; &quot;AGAGCGATCGGCGGTT&quot; &quot;AGAGCGATCGGCTTGG&quot;
## [893] &quot;AGAGCGATCTGTCTCG&quot; &quot;AGAGCTTAGACTAGGC&quot; &quot;AGAGCTTAGCCACGTC&quot; &quot;AGAGCTTAGTCGTTTG&quot;
## [897] &quot;AGAGCTTAGTGGGCTA&quot; &quot;AGAGCTTCAAGTACCT&quot; &quot;AGAGCTTCACAGCCCA&quot; &quot;AGAGCTTCACCCAGTG&quot;
## [901] &quot;AGAGCTTCACGCTTTC&quot; &quot;AGAGCTTCAGTATCTG&quot; &quot;AGAGCTTCATAGTAAG&quot; &quot;AGAGCTTGTCTAAACC&quot;
## [905] &quot;AGAGCTTGTGCTAGCC&quot; &quot;AGAGCTTGTGGCAAAC&quot; &quot;AGAGCTTGTGGTACAG&quot;</code></pre>
<div class="sourceCode" id="cb45"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb45-1"><a href="the-following-examples-use-the-pbmc-3k-dataset.html#cb45-1"></a><span class="co"># One can pull multiple values from the data frame at any time</span></span>
<span id="cb45-2"><a href="the-following-examples-use-the-pbmc-3k-dataset.html#cb45-2"></a><span class="kw">head</span>(<span class="dt">x =</span> seurat<span class="op">@</span>meta.data[<span class="kw">c</span>(<span class="st">&#39;nCount_RNA&#39;</span>, <span class="st">&#39;nFeature_RNA&#39;</span>)])</span></code></pre></div>
<pre><code>##                  nCount_RNA nFeature_RNA
## AAACCTGAGCTAGTCT       3605         1184
## AAACCTGAGGGCACTA       3828         1387
## AAACCTGAGTACGTTC       6452         1783
## AAACCTGAGTCCGGTC       3071         1088
## AAACCTGCACCAGGTC       9389         2616
## AAACCTGCACCTCGTT      48827         5591</code></pre>
<div class="sourceCode" id="cb47"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb47-1"><a href="the-following-examples-use-the-pbmc-3k-dataset.html#cb47-1"></a><span class="co"># The $ sigil can only pull bit of meta data at a time; however, tab-autocompletion</span></span>
<span id="cb47-2"><a href="the-following-examples-use-the-pbmc-3k-dataset.html#cb47-2"></a><span class="co"># has been enabled for the $ sigil, making it ideal for interactive use</span></span>
<span id="cb47-3"><a href="the-following-examples-use-the-pbmc-3k-dataset.html#cb47-3"></a></span>
<span id="cb47-4"><a href="the-following-examples-use-the-pbmc-3k-dataset.html#cb47-4"></a><span class="kw">head</span>(<span class="dt">x =</span> seurat<span class="op">@</span>meta.data<span class="op">$</span>nFeature_RNA)</span></code></pre></div>
<pre><code>## [1] 1184 1387 1783 1088 2616 5591</code></pre>
<div class="sourceCode" id="cb49"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb49-1"><a href="the-following-examples-use-the-pbmc-3k-dataset.html#cb49-1"></a><span class="co"># Passing `drop = TRUE` will turn the meta data into a names vector</span></span>
<span id="cb49-2"><a href="the-following-examples-use-the-pbmc-3k-dataset.html#cb49-2"></a><span class="co"># with each entry being named for the cell it corresponds to</span></span>
<span id="cb49-3"><a href="the-following-examples-use-the-pbmc-3k-dataset.html#cb49-3"></a><span class="kw">head</span>(<span class="dt">x =</span> seurat<span class="op">@</span>meta.data[<span class="st">&#39;nFeature_RNA&#39;</span>, <span class="dt">drop =</span> <span class="ot">TRUE</span>])</span></code></pre></div>
<pre><code>## Warning in `[.data.frame`(seurat@meta.data, &quot;nFeature_RNA&quot;, drop = TRUE): &#39;drop&#39; argument will
## be ignored</code></pre>
<pre><code>##                  nFeature_RNA
## AAACCTGAGCTAGTCT         1184
## AAACCTGAGGGCACTA         1387
## AAACCTGAGTACGTTC         1783
## AAACCTGAGTCCGGTC         1088
## AAACCTGCACCAGGTC         2616
## AAACCTGCACCTCGTT         5591</code></pre>
<div class="sourceCode" id="cb52"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb52-1"><a href="the-following-examples-use-the-pbmc-3k-dataset.html#cb52-1"></a><span class="co"># Add meta data example</span></span></code></pre></div>
</div>
<div id="methods" class="section level4">
<h4><span class="header-section-number">5.0.0.2</span> Methods</h4>
<p>Methods for the Seurat class can be found with the following:</p>
<div class="sourceCode" id="cb53"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb53-1"><a href="the-following-examples-use-the-pbmc-3k-dataset.html#cb53-1"></a>utils<span class="op">::</span><span class="kw">methods</span>(<span class="dt">class =</span> <span class="st">&#39;Seurat&#39;</span>)</span></code></pre></div>
<pre><code>##  [1] [                       [[                      [[&lt;-                   
##  [4] $                       $&lt;-                     AddMetaData            
##  [7] as.CellDataSet          as.loom                 as.SingleCellExperiment
## [10] colMeans                colSums                 Command                
## [13] DefaultAssay            DefaultAssay&lt;-          dim                    
## [16] dimnames                droplevels              Embeddings             
## [19] FindClusters            FindMarkers             FindNeighbors          
## [22] FindVariableFeatures    GetAssay                GetAssayData           
## [25] HVFInfo                 Idents                  Idents&lt;-               
## [28] Key                     levels                  levels&lt;-               
## [31] Loadings                merge                   Misc                   
## [34] Misc&lt;-                  names                   NormalizeData          
## [37] OldWhichCells           Project                 Project&lt;-              
## [40] RenameCells             RenameIdents            ReorderIdent           
## [43] rowMeans                rowSums                 RunALRA                
## [46] RunCCA                  RunICA                  RunLSI                 
## [49] RunPCA                  RunTSNE                 RunUMAP                
## [52] ScaleData               ScoreJackStraw          SetAssayData           
## [55] SetIdent                show                    StashIdent             
## [58] Stdev                   subset                  SubsetData             
## [61] Tool                    Tool&lt;-                  VariableFeatures       
## [64] VariableFeatures&lt;-      WhichCells             
## see &#39;?methods&#39; for accessing help and source code</code></pre>
<p>You can also list all functions in the Seurat package by using:</p>
<div class="sourceCode" id="cb55"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb55-1"><a href="the-following-examples-use-the-pbmc-3k-dataset.html#cb55-1"></a><span class="kw">ls</span>(<span class="st">&quot;package:Seurat&quot;</span>)</span></code></pre></div>
<pre><code>##   [1] &quot;AddMetaData&quot;                     &quot;AddModuleScore&quot;                 
##   [3] &quot;ALRAChooseKPlot&quot;                 &quot;as.CellDataSet&quot;                 
##   [5] &quot;as.Graph&quot;                        &quot;as.loom&quot;                        
##   [7] &quot;as.Seurat&quot;                       &quot;as.SingleCellExperiment&quot;        
##   [9] &quot;as.sparse&quot;                       &quot;Assays&quot;                         
##  [11] &quot;AugmentPlot&quot;                     &quot;AverageExpression&quot;              
##  [13] &quot;BarcodeInflectionsPlot&quot;          &quot;BlackAndWhite&quot;                  
##  [15] &quot;BlueAndRed&quot;                      &quot;BoldTitle&quot;                      
##  [17] &quot;BuildClusterTree&quot;                &quot;CalculateBarcodeInflections&quot;    
##  [19] &quot;CaseMatch&quot;                       &quot;cc.genes&quot;                       
##  [21] &quot;cc.genes.updated.2019&quot;           &quot;CellCycleScoring&quot;               
##  [23] &quot;Cells&quot;                           &quot;CellsByIdentities&quot;              
##  [25] &quot;CellScatter&quot;                     &quot;CellSelector&quot;                   
##  [27] &quot;CollapseEmbeddingOutliers&quot;       &quot;CollapseSpeciesExpressionMatrix&quot;
##  [29] &quot;ColorDimSplit&quot;                   &quot;CombinePlots&quot;                   
##  [31] &quot;Command&quot;                         &quot;CreateAssayObject&quot;              
##  [33] &quot;CreateDimReducObject&quot;            &quot;CreateGeneActivityMatrix&quot;       
##  [35] &quot;CreateSeuratObject&quot;              &quot;CustomDistance&quot;                 
##  [37] &quot;CustomPalette&quot;                   &quot;DarkTheme&quot;                      
##  [39] &quot;DefaultAssay&quot;                    &quot;DefaultAssay&lt;-&quot;                 
##  [41] &quot;DietSeurat&quot;                      &quot;DimHeatmap&quot;                     
##  [43] &quot;DimPlot&quot;                         &quot;DoHeatmap&quot;                      
##  [45] &quot;DotPlot&quot;                         &quot;ElbowPlot&quot;                      
##  [47] &quot;Embeddings&quot;                      &quot;ExpMean&quot;                        
##  [49] &quot;ExportToCellbrowser&quot;             &quot;ExpSD&quot;                          
##  [51] &quot;ExpVar&quot;                          &quot;FeatureLocator&quot;                 
##  [53] &quot;FeaturePlot&quot;                     &quot;FeatureScatter&quot;                 
##  [55] &quot;FetchData&quot;                       &quot;FindAllMarkers&quot;                 
##  [57] &quot;FindClusters&quot;                    &quot;FindConservedMarkers&quot;           
##  [59] &quot;FindIntegrationAnchors&quot;          &quot;FindMarkers&quot;                    
##  [61] &quot;FindNeighbors&quot;                   &quot;FindTransferAnchors&quot;            
##  [63] &quot;FindVariableFeatures&quot;            &quot;FontSize&quot;                       
##  [65] &quot;GeneSymbolThesarus&quot;              &quot;GetAssay&quot;                       
##  [67] &quot;GetAssayData&quot;                    &quot;GetIntegrationData&quot;             
##  [69] &quot;GetResidual&quot;                     &quot;HoverLocator&quot;                   
##  [71] &quot;HTODemux&quot;                        &quot;HTOHeatmap&quot;                     
##  [73] &quot;HVFInfo&quot;                         &quot;Idents&quot;                         
##  [75] &quot;Idents&lt;-&quot;                        &quot;IntegrateData&quot;                  
##  [77] &quot;IsGlobal&quot;                        &quot;JackStraw&quot;                      
##  [79] &quot;JackStrawPlot&quot;                   &quot;JS&quot;                             
##  [81] &quot;JS&lt;-&quot;                            &quot;Key&quot;                            
##  [83] &quot;Key&lt;-&quot;                           &quot;L2CCA&quot;                          
##  [85] &quot;L2Dim&quot;                           &quot;LabelClusters&quot;                  
##  [87] &quot;LabelPoints&quot;                     &quot;Loadings&quot;                       
##  [89] &quot;Loadings&lt;-&quot;                      &quot;LocalStruct&quot;                    
##  [91] &quot;LogNormalize&quot;                    &quot;LogSeuratCommand&quot;               
##  [93] &quot;LogVMR&quot;                          &quot;MetaFeature&quot;                    
##  [95] &quot;MinMax&quot;                          &quot;Misc&quot;                           
##  [97] &quot;Misc&lt;-&quot;                          &quot;MixingMetric&quot;                   
##  [99] &quot;MULTIseqDemux&quot;                   &quot;NoAxes&quot;                         
## [101] &quot;NoGrid&quot;                          &quot;NoLegend&quot;                       
## [103] &quot;NormalizeData&quot;                   &quot;OldWhichCells&quot;                  
## [105] &quot;pbmc_small&quot;                      &quot;PCAPlot&quot;                        
## [107] &quot;PCASigGenes&quot;                     &quot;PCHeatmap&quot;                      
## [109] &quot;PercentageFeatureSet&quot;            &quot;PlotClusterTree&quot;                
## [111] &quot;PolyDimPlot&quot;                     &quot;PolyFeaturePlot&quot;                
## [113] &quot;PrepSCTIntegration&quot;              &quot;Project&quot;                        
## [115] &quot;Project&lt;-&quot;                       &quot;ProjectDim&quot;                     
## [117] &quot;PurpleAndYellow&quot;                 &quot;Read10X&quot;                        
## [119] &quot;Read10X_h5&quot;                      &quot;ReadAlevin&quot;                     
## [121] &quot;ReadAlevinCsv&quot;                   &quot;ReadH5AD&quot;                       
## [123] &quot;Reductions&quot;                      &quot;RegroupIdents&quot;                  
## [125] &quot;RelativeCounts&quot;                  &quot;RenameAssays&quot;                   
## [127] &quot;RenameCells&quot;                     &quot;RenameIdents&quot;                   
## [129] &quot;ReorderIdent&quot;                    &quot;RestoreLegend&quot;                  
## [131] &quot;RidgePlot&quot;                       &quot;RotatedAxis&quot;                    
## [133] &quot;RowMergeSparseMatrices&quot;          &quot;RunALRA&quot;                        
## [135] &quot;RunCCA&quot;                          &quot;RunICA&quot;                         
## [137] &quot;RunLSI&quot;                          &quot;RunPCA&quot;                         
## [139] &quot;RunTSNE&quot;                         &quot;RunUMAP&quot;                        
## [141] &quot;SampleUMI&quot;                       &quot;ScaleData&quot;                      
## [143] &quot;ScoreJackStraw&quot;                  &quot;SCTransform&quot;                    
## [145] &quot;SelectIntegrationFeatures&quot;       &quot;SetAssayData&quot;                   
## [147] &quot;SetIdent&quot;                        &quot;SetIntegrationData&quot;             
## [149] &quot;SeuratAxes&quot;                      &quot;SeuratTheme&quot;                    
## [151] &quot;SpatialTheme&quot;                    &quot;SplitObject&quot;                    
## [153] &quot;StashIdent&quot;                      &quot;Stdev&quot;                          
## [155] &quot;StopCellbrowser&quot;                 &quot;SubsetByBarcodeInflections&quot;     
## [157] &quot;SubsetData&quot;                      &quot;TF.IDF&quot;                         
## [159] &quot;Tool&quot;                            &quot;Tool&lt;-&quot;                         
## [161] &quot;TopCells&quot;                        &quot;TopFeatures&quot;                    
## [163] &quot;TransferData&quot;                    &quot;TSNEPlot&quot;                       
## [165] &quot;UMAPPlot&quot;                        &quot;UpdateSeuratObject&quot;             
## [167] &quot;UpdateSymbolList&quot;                &quot;VariableFeaturePlot&quot;            
## [169] &quot;VariableFeatures&quot;                &quot;VariableFeatures&lt;-&quot;             
## [171] &quot;VizDimLoadings&quot;                  &quot;VlnPlot&quot;                        
## [173] &quot;WhichCells&quot;                      &quot;WhiteBackground&quot;</code></pre>
</div>
<div id="preprocessing-step-1-filter-out-low-quality-cells" class="section level2">
<h2><span class="header-section-number">5.1</span> Preprocessing step 1 : Filter out low-quality cells</h2>
<p>The Seurat object initialization step above only considered cells that expressed at least 350 genes. Additionally, we would like to exclude cells that are damaged. A common metric to judge this (although by no means the only one) is the relative expression of mitochondrially derived genes. When the cells apoptose due to stress, their mitochondria becomes leaky and there is widespread RNA degradation. Thus a relative enrichment of mitochondrially derived genes can be a tell-tale sign of cell stress. Here, we compute the proportion of transcripts that are of mitochondrial origin for every cell (<code>percent.mt</code>), and visualize its distribution as a violin plot. We also use the <code>FeatureScatter</code> function to observe how <code>percent.mt</code> correlates with other metrics.</p>
<div class="sourceCode" id="cb57"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb57-1"><a href="the-following-examples-use-the-pbmc-3k-dataset.html#cb57-1"></a><span class="co"># The number of genes and UMIs (nFeature_RNA nCount_RNA) are automatically calculated</span></span>
<span id="cb57-2"><a href="the-following-examples-use-the-pbmc-3k-dataset.html#cb57-2"></a><span class="co"># for every object by Seurat.  For non-UMI data, nCount_RNA represents the sum of</span></span>
<span id="cb57-3"><a href="the-following-examples-use-the-pbmc-3k-dataset.html#cb57-3"></a><span class="co"># the non-normalized values within a cell We calculate the percentage of</span></span>
<span id="cb57-4"><a href="the-following-examples-use-the-pbmc-3k-dataset.html#cb57-4"></a><span class="co"># mitochondrial genes here and store it in percent.mt using AddMetaData.</span></span>
<span id="cb57-5"><a href="the-following-examples-use-the-pbmc-3k-dataset.html#cb57-5"></a><span class="co"># We use GetAssayData(object = seurat, slot = &#39;data&#39;) since this represents non-transformed and</span></span>
<span id="cb57-6"><a href="the-following-examples-use-the-pbmc-3k-dataset.html#cb57-6"></a><span class="co"># non-log-normalized counts The % of UMI mapping to MT-genes is a common</span></span>
<span id="cb57-7"><a href="the-following-examples-use-the-pbmc-3k-dataset.html#cb57-7"></a><span class="co"># scRNA-seq QC metric.</span></span>
<span id="cb57-8"><a href="the-following-examples-use-the-pbmc-3k-dataset.html#cb57-8"></a></span>
<span id="cb57-9"><a href="the-following-examples-use-the-pbmc-3k-dataset.html#cb57-9"></a></span>
<span id="cb57-10"><a href="the-following-examples-use-the-pbmc-3k-dataset.html#cb57-10"></a><span class="co"># The [[ operator can add columns to object metadata. This is a great place to stash QC stats</span></span>
<span id="cb57-11"><a href="the-following-examples-use-the-pbmc-3k-dataset.html#cb57-11"></a>seurat[[<span class="st">&quot;percent.mt&quot;</span>]] &lt;-<span class="st"> </span><span class="kw">PercentageFeatureSet</span>(<span class="dt">object =</span> seurat, <span class="dt">pattern =</span> <span class="st">&quot;^MT-&quot;</span>)</span>
<span id="cb57-12"><a href="the-following-examples-use-the-pbmc-3k-dataset.html#cb57-12"></a></span>
<span id="cb57-13"><a href="the-following-examples-use-the-pbmc-3k-dataset.html#cb57-13"></a><span class="co"># PercentageFeatureSet adds columns to object@meta.data, and is a great place to stash QC stats.</span></span>
<span id="cb57-14"><a href="the-following-examples-use-the-pbmc-3k-dataset.html#cb57-14"></a><span class="co"># This also allows us to plot the metadata values using the Seurat&#39;s VlnPlot().</span></span>
<span id="cb57-15"><a href="the-following-examples-use-the-pbmc-3k-dataset.html#cb57-15"></a><span class="kw">head</span>(seurat<span class="op">@</span>meta.data) <span class="co"># Before adding</span></span></code></pre></div>
<pre><code>##                  orig.ident nCount_RNA nFeature_RNA percent.mt
## AAACCTGAGCTAGTCT  10X_NSCLC       3605         1184  20.832178
## AAACCTGAGGGCACTA  10X_NSCLC       3828         1387   3.448276
## AAACCTGAGTACGTTC  10X_NSCLC       6452         1783   2.867328
## AAACCTGAGTCCGGTC  10X_NSCLC       3071         1088   6.284598
## AAACCTGCACCAGGTC  10X_NSCLC       9389         2616   3.205879
## AAACCTGCACCTCGTT  10X_NSCLC      48827         5591   2.322486</code></pre>
<div class="sourceCode" id="cb59"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb59-1"><a href="the-following-examples-use-the-pbmc-3k-dataset.html#cb59-1"></a><span class="kw">VlnPlot</span>(<span class="dt">object =</span> seurat, <span class="dt">features =</span> <span class="kw">c</span>(<span class="st">&quot;nFeature_RNA&quot;</span>, <span class="st">&quot;nCount_RNA&quot;</span>, <span class="st">&quot;percent.mt&quot;</span>), <span class="dt">ncol =</span> <span class="dv">3</span>)</span></code></pre></div>
<p><img src="KrumlovSingleCellWorkshop2020_files/figure-html/vln_plot-1.png" width="672" /></p>
<p>Here we calculated the percent mitochondrial reads and added it to the Seurat object in the slot named meta.data. This allowed us to plot using the violin plot function provided by Seurat.</p>
<p>A third metric we use is the number of house keeping genes expressed in a cell. These genes reflect commomn processes active in a cell and hence are a good global quality measure. They are also abundant and are usually steadliy expressed in cells, thus less sensitive to the high dropout.</p>
<div class="sourceCode" id="cb60"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb60-1"><a href="the-following-examples-use-the-pbmc-3k-dataset.html#cb60-1"></a><span class="co"># Load the the list of house keeping genes</span></span>
<span id="cb60-2"><a href="the-following-examples-use-the-pbmc-3k-dataset.html#cb60-2"></a>hkgenes &lt;-<span class="st"> </span><span class="kw">read.table</span>(<span class="kw">paste0</span>(dirname, <span class="st">&quot;housekeepers.txt&quot;</span>), <span class="dt">skip =</span> <span class="dv">2</span>)</span>
<span id="cb60-3"><a href="the-following-examples-use-the-pbmc-3k-dataset.html#cb60-3"></a>hkgenes &lt;-<span class="st"> </span><span class="kw">as.vector</span>(hkgenes<span class="op">$</span>V1)</span>
<span id="cb60-4"><a href="the-following-examples-use-the-pbmc-3k-dataset.html#cb60-4"></a></span>
<span id="cb60-5"><a href="the-following-examples-use-the-pbmc-3k-dataset.html#cb60-5"></a><span class="co"># remove hkgenes that were not found</span></span>
<span id="cb60-6"><a href="the-following-examples-use-the-pbmc-3k-dataset.html#cb60-6"></a>hkgenes.found &lt;-<span class="st"> </span><span class="kw">which</span>(<span class="kw">toupper</span>(<span class="kw">rownames</span>(seurat<span class="op">@</span>assays<span class="op">$</span>RNA<span class="op">@</span>data)) <span class="op">%in%</span><span class="st"> </span>hkgenes)</span></code></pre></div>
<p>Possible task: Feel like challenging yourself? write the code to do the following:
1. Sum the number of detected house keeping genes for each cell
2. Add this information as meta data to seurat
3. plot all metrics: “nGene”, “nUMI”, “percent.mito”,“n.exp.hkgenes” using VlnPlot
4. Scroll down to see if you got it!</p>
<p>If you feel like going through a more guided version, scroll down and follow the instructions.</p>
<p><strong>Alternative task:</strong> Sum the number of detected house keeping genes for each cell, then add this to the meta data</p>
<div class="sourceCode" id="cb61"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb61-1"><a href="the-following-examples-use-the-pbmc-3k-dataset.html#cb61-1"></a><span class="co">#### n.expressed.hkgenes &lt;- ?(seurat@data[hkgenes.found, ] &gt; ?)</span></span>
<span id="cb61-2"><a href="the-following-examples-use-the-pbmc-3k-dataset.html#cb61-2"></a><span class="co">#### seurat &lt;- AddMetaData(object = ?, ? = ?, col.name = &quot;n.exp.hkgenes&quot;)</span></span>
<span id="cb61-3"><a href="the-following-examples-use-the-pbmc-3k-dataset.html#cb61-3"></a>n.expressed.hkgenes &lt;-<span class="st"> </span>Matrix<span class="op">::</span><span class="kw">colSums</span>(seurat<span class="op">@</span>assays<span class="op">$</span>RNA<span class="op">@</span>data[hkgenes.found, ] <span class="op">&gt;</span><span class="st"> </span><span class="dv">0</span>)</span>
<span id="cb61-4"><a href="the-following-examples-use-the-pbmc-3k-dataset.html#cb61-4"></a>seurat &lt;-<span class="st"> </span><span class="kw">AddMetaData</span>(<span class="dt">object =</span> seurat, <span class="dt">metadata =</span> n.expressed.hkgenes, <span class="dt">col.name =</span> <span class="st">&quot;n.exp.hkgenes&quot;</span>)</span>
<span id="cb61-5"><a href="the-following-examples-use-the-pbmc-3k-dataset.html#cb61-5"></a><span class="kw">VlnPlot</span>(<span class="dt">object =</span> seurat, <span class="dt">features =</span> <span class="kw">c</span>(<span class="st">&quot;nFeature_RNA&quot;</span>, <span class="st">&quot;nCount_RNA&quot;</span>, <span class="st">&quot;percent.mt&quot;</span>, <span class="st">&quot;n.exp.hkgenes&quot;</span>), <span class="dt">ncol =</span> <span class="dv">2</span>)</span></code></pre></div>
<p><img src="KrumlovSingleCellWorkshop2020_files/figure-html/Add_number_of_house_keeping_genes-1.png" width="672" /></p>
<p>Is there a correlation between the measurements? For example, number of UMIs with number of genes?
Possible task: Feel like challenging yourself? write the code to do the following:
Can you plot the nGene vs nUMI (hint:GenePlot)? What is the correlation? Do you see a strange subpopulation? What do you think happened with these cells?</p>
<div class="sourceCode" id="cb62"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb62-1"><a href="the-following-examples-use-the-pbmc-3k-dataset.html#cb62-1"></a>seurat</span></code></pre></div>
<p>Scroll down to see the command</p>
<p><strong>Alternative task:</strong>
Can you plot the nFeature_RNA vs nCount_RNA (hint:FeatureScatter)? What is the correlation? Do you see a strange subpopulation? What do you think happened with these cells?</p>
<div class="sourceCode" id="cb63"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb63-1"><a href="the-following-examples-use-the-pbmc-3k-dataset.html#cb63-1"></a><span class="co"># FeatureScatter is typically used to visualize feature-feature relationships, but can be used</span></span>
<span id="cb63-2"><a href="the-following-examples-use-the-pbmc-3k-dataset.html#cb63-2"></a><span class="co"># for anything calculated by the object, i.e. columns in object metadata, PC scores etc.</span></span>
<span id="cb63-3"><a href="the-following-examples-use-the-pbmc-3k-dataset.html#cb63-3"></a></span>
<span id="cb63-4"><a href="the-following-examples-use-the-pbmc-3k-dataset.html#cb63-4"></a>plot1 &lt;-<span class="st"> </span><span class="kw">FeatureScatter</span>(seurat, <span class="dt">feature1 =</span> <span class="st">&quot;nCount_RNA&quot;</span>, <span class="dt">feature2 =</span> <span class="st">&quot;percent.mt&quot;</span>)</span>
<span id="cb63-5"><a href="the-following-examples-use-the-pbmc-3k-dataset.html#cb63-5"></a>plot2 &lt;-<span class="st"> </span><span class="kw">FeatureScatter</span>(seurat, <span class="dt">feature1 =</span> <span class="st">&quot;nCount_RNA&quot;</span>, <span class="dt">feature2 =</span> <span class="st">&quot;nFeature_RNA&quot;</span>)</span>
<span id="cb63-6"><a href="the-following-examples-use-the-pbmc-3k-dataset.html#cb63-6"></a><span class="kw">CombinePlots</span>(<span class="dt">plots =</span> <span class="kw">list</span>(plot1, plot2))</span></code></pre></div>
<p><img src="KrumlovSingleCellWorkshop2020_files/figure-html/alt_task-1.png" width="672" /></p>
<div class="sourceCode" id="cb64"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb64-1"><a href="the-following-examples-use-the-pbmc-3k-dataset.html#cb64-1"></a><span class="co">### FeatureScatter(object = seurat, feature1 = ?, feature2 = ?)  ## could be genes or meta data columns</span></span>
<span id="cb64-2"><a href="the-following-examples-use-the-pbmc-3k-dataset.html#cb64-2"></a><span class="kw">FeatureScatter</span>(<span class="dt">object =</span> seurat, <span class="dt">feature1 =</span> <span class="st">&quot;nCount_RNA&quot;</span>, <span class="dt">feature2 =</span> <span class="st">&quot;nFeature_RNA&quot;</span>)</span></code></pre></div>
</div>
<div id="examine-contents-of-seurat-object" class="section level2">
<h2><span class="header-section-number">5.2</span> Examine contents of Seurat object</h2>
<div class="sourceCode" id="cb65"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb65-1"><a href="the-following-examples-use-the-pbmc-3k-dataset.html#cb65-1"></a><span class="kw">str</span>(seurat)</span></code></pre></div>
<p>These are the slots in the Seurat object. Some of the slots are automatically updated by Seurat as you move through analysis. Take a moment to look through the information, knowing the slots allow you to leverage work Seurat has already done for you.</p>
<div class="sourceCode" id="cb66"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb66-1"><a href="the-following-examples-use-the-pbmc-3k-dataset.html#cb66-1"></a><span class="kw">VlnPlot</span>(<span class="dt">object =</span> seurat, <span class="dt">features =</span> <span class="kw">c</span>(<span class="st">&quot;nFeature_RNA&quot;</span>), <span class="dt">group.by =</span> <span class="kw">c</span>(<span class="st">&#39;orig.ident&#39;</span>))</span></code></pre></div>
<p>Here we plot the number of genes per cell by what Seurat calls orig.ident. Identity is a concept that is used in the Seurat object to refer to the cell identity. In this case, the cell identity is 10X_NSCLC, but after we cluster the cells, the cell identity will be whatever cluster the cell belongs to. We will see how identity updates as we go throught the analysis.</p>
<p>Next, let’s filter the cells based on the quality control metrics.
Filter based on:
1. nFeature_RNA
2. percent.mt
3. n.exp.hkgenes</p>
<p><strong>Task: Change the thresholds to what you think they should be according to the violin plots</strong></p>
<div class="sourceCode" id="cb67"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb67-1"><a href="the-following-examples-use-the-pbmc-3k-dataset.html#cb67-1"></a><span class="kw">VlnPlot</span>(<span class="dt">object =</span> seurat, <span class="dt">features =</span> <span class="kw">c</span>(<span class="st">&quot;nFeature_RNA&quot;</span>,<span class="st">&quot;percent.mt&quot;</span>,<span class="st">&quot;n.exp.hkgenes&quot;</span>), <span class="dt">ncol =</span> <span class="dv">3</span>)</span></code></pre></div>
<div class="sourceCode" id="cb68"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb68-1"><a href="the-following-examples-use-the-pbmc-3k-dataset.html#cb68-1"></a><span class="co">#### seurat &lt;- FilterCells(object = seurat, subset.names = c(&quot;nGene&quot;, &quot;percent.mito&quot;,&quot;n.exp.hkgenes&quot;), low.thresholds = c(350, -Inf,55), high.thresholds = c(5000, 0.1, Inf))</span></span></code></pre></div>
<p>How many cells are you left with?</p>
<div class="sourceCode" id="cb69"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb69-1"><a href="the-following-examples-use-the-pbmc-3k-dataset.html#cb69-1"></a>seurat</span></code></pre></div>
<div id="preprocessing-step-2-expression-normalization" class="section level3">
<h3><span class="header-section-number">5.2.1</span> Preprocessing step 2 : Expression normalization</h3>
<p>After removing unwanted genes cells from the dataset, the next step is to normalize the data. By default, we employ a global-scaling normalization method “LogNormalize” that normalizes the gene expression measurements for each cell by the total expression, multiplies this by a scale factor (10,000 by default), and log-transforms the result. There have been many methods to normalize the data, but this is the simplest and the most intuitive. The division by total expression is done to change all expression counts to a relative measure, since experience has suggested that technical factors (e.g. capture rate, efficiency of reverse transcription) are largely responsible for the variation in the number of molecules per cell, although genuine biological factors (e.g. cell cycle stage, cell size) also play a smaller, but non-negligible role. The log-transformation is a commonly used transformation that has many desirable properties, such as variance stabilization (can you think of others?).</p>
<div class="sourceCode" id="cb70"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb70-1"><a href="the-following-examples-use-the-pbmc-3k-dataset.html#cb70-1"></a>seurat &lt;-<span class="st"> </span><span class="kw">NormalizeData</span>(<span class="dt">object =</span> seurat, <span class="dt">normalization.method =</span> <span class="st">&quot;LogNormalize&quot;</span>, <span class="dt">scale.factor =</span> <span class="fl">1e4</span>)</span></code></pre></div>
<p>Well there you have it! A filtered and normalized gene-expression data set. A great accomplishment for your first dive into scRNA-Seq analysis. Well done!</p>
</div>
</div>
<div id="detection-of-variable-genes-across-the-single-cells" class="section level2">
<h2><span class="header-section-number">5.3</span> Detection of variable genes across the single cells</h2>
<p>Seurat calculates highly variable genes and focuses on these for downstream analysis. <strong><code>FindVariableFeatures</code></strong> calculates the average expression and dispersion for each gene, places these genes into bins, and then calculates a z-score for dispersion within each bin. This helps control for the relationship between variability and average expression. This function is unchanged from (Macosko <em>et al</em>.), but new methods for variable gene expression identification are coming soon. We suggest that users set these parameters to mark visual outliers on the dispersion plot, but the exact parameter settings may vary based on the data type, heterogeneity in the sample, and normalization strategy. The parameters here identify ~3,000 variable genes, and represent typical parameter settings for UMI data that is normalized to a total of 1e4 molecules.</p>
<div class="sourceCode" id="cb71"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb71-1"><a href="the-following-examples-use-the-pbmc-3k-dataset.html#cb71-1"></a><span class="co">### seurat &lt;- FindVariableFeatures(object = seurat, selection.method = ?, nfeatures = ?) </span></span>
<span id="cb71-2"><a href="the-following-examples-use-the-pbmc-3k-dataset.html#cb71-2"></a><span class="co">### Task: ?FindVariableFeatures into the console to read about different selection methods</span></span>
<span id="cb71-3"><a href="the-following-examples-use-the-pbmc-3k-dataset.html#cb71-3"></a>seurat &lt;-<span class="st"> </span><span class="kw">FindVariableFeatures</span>(<span class="dt">object =</span> seurat, <span class="dt">selection.method =</span> <span class="st">&quot;vst&quot;</span>, <span class="dt">nfeatures =</span> <span class="dv">2000</span>)</span>
<span id="cb71-4"><a href="the-following-examples-use-the-pbmc-3k-dataset.html#cb71-4"></a></span>
<span id="cb71-5"><a href="the-following-examples-use-the-pbmc-3k-dataset.html#cb71-5"></a><span class="co"># Identify the 10 most highly variable genes</span></span>
<span id="cb71-6"><a href="the-following-examples-use-the-pbmc-3k-dataset.html#cb71-6"></a>top10 &lt;-<span class="st"> </span><span class="kw">head</span>(<span class="kw">VariableFeatures</span>(seurat), <span class="dv">10</span>)</span></code></pre></div>
<p>We can see the Seurat object slots have updated for the FindVariableFetures section. Let’s use the slot to see how many variable genes we found.</p>
<div class="sourceCode" id="cb72"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb72-1"><a href="the-following-examples-use-the-pbmc-3k-dataset.html#cb72-1"></a><span class="kw">str</span>(seurat)</span>
<span id="cb72-2"><a href="the-following-examples-use-the-pbmc-3k-dataset.html#cb72-2"></a><span class="kw">length</span>(<span class="dt">x =</span> seurat<span class="op">@</span>assays<span class="op">$</span>RNA<span class="op">@</span>var.features)</span></code></pre></div>
<p><strong>Task: how does changing the parameters for find variable genes function changes the number of the found genes?</strong>
Play with the parameters - what makes the function find more variable genes? less?</p>
<div class="sourceCode" id="cb73"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb73-1"><a href="the-following-examples-use-the-pbmc-3k-dataset.html#cb73-1"></a>seurat &lt;-<span class="st"> </span><span class="kw">FindVariableFeatures</span>(<span class="dt">object =</span> seurat, <span class="dt">selection.method =</span> <span class="st">&quot;vst&quot;</span>, <span class="dt">nfeatures =</span> <span class="dv">2000</span>, </span>
<span id="cb73-2"><a href="the-following-examples-use-the-pbmc-3k-dataset.html#cb73-2"></a>                               <span class="dt">mean.function =</span> ExpMean, <span class="dt">dispersion.function =</span> LogVMR, </span>
<span id="cb73-3"><a href="the-following-examples-use-the-pbmc-3k-dataset.html#cb73-3"></a>                               <span class="dt">num.bin =</span> <span class="dv">40</span>, </span>
<span id="cb73-4"><a href="the-following-examples-use-the-pbmc-3k-dataset.html#cb73-4"></a>                               <span class="dt">mean.cutoff =</span> <span class="kw">c</span>(<span class="fl">0.0125</span>, <span class="dv">1</span>),</span>
<span id="cb73-5"><a href="the-following-examples-use-the-pbmc-3k-dataset.html#cb73-5"></a>                               <span class="dt">dispersion.cutoff =</span> <span class="kw">c</span>(<span class="dv">0</span>, <span class="fl">0.5</span>))</span>
<span id="cb73-6"><a href="the-following-examples-use-the-pbmc-3k-dataset.html#cb73-6"></a></span>
<span id="cb73-7"><a href="the-following-examples-use-the-pbmc-3k-dataset.html#cb73-7"></a><span class="co">## Check number of variable genes</span></span>
<span id="cb73-8"><a href="the-following-examples-use-the-pbmc-3k-dataset.html#cb73-8"></a><span class="kw">length</span>(seurat<span class="op">@</span>assays<span class="op">$</span>RNA<span class="op">@</span>var.features)</span></code></pre></div>
<div class="sourceCode" id="cb74"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb74-1"><a href="the-following-examples-use-the-pbmc-3k-dataset.html#cb74-1"></a>seurat &lt;-<span class="st"> </span><span class="kw">FindVariableFeatures</span>(<span class="dt">object =</span> seurat, <span class="dt">selection.method =</span> <span class="st">&quot;vst&quot;</span>, <span class="dt">nfeatures =</span> <span class="dv">2000</span>, </span>
<span id="cb74-2"><a href="the-following-examples-use-the-pbmc-3k-dataset.html#cb74-2"></a>                               <span class="dt">mean.function =</span> ExpMean, <span class="dt">dispersion.function =</span> LogVMR, </span>
<span id="cb74-3"><a href="the-following-examples-use-the-pbmc-3k-dataset.html#cb74-3"></a>                               <span class="dt">num.bin =</span> <span class="dv">10</span>, </span>
<span id="cb74-4"><a href="the-following-examples-use-the-pbmc-3k-dataset.html#cb74-4"></a>                               <span class="dt">mean.cutoff =</span> <span class="kw">c</span>(<span class="fl">0.0125</span>, <span class="dv">1</span>),</span>
<span id="cb74-5"><a href="the-following-examples-use-the-pbmc-3k-dataset.html#cb74-5"></a>                               <span class="dt">dispersion.cutoff =</span> <span class="kw">c</span>(<span class="dv">0</span>, <span class="fl">0.5</span>))</span>
<span id="cb74-6"><a href="the-following-examples-use-the-pbmc-3k-dataset.html#cb74-6"></a></span>
<span id="cb74-7"><a href="the-following-examples-use-the-pbmc-3k-dataset.html#cb74-7"></a><span class="co">## Check number of variable genes</span></span>
<span id="cb74-8"><a href="the-following-examples-use-the-pbmc-3k-dataset.html#cb74-8"></a><span class="kw">length</span>(seurat<span class="op">@</span>assays<span class="op">$</span>RNA<span class="op">@</span>var.features)</span></code></pre></div>
<div class="sourceCode" id="cb75"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb75-1"><a href="the-following-examples-use-the-pbmc-3k-dataset.html#cb75-1"></a>seurat &lt;-<span class="st"> </span><span class="kw">FindVariableFeatures</span>(<span class="dt">object =</span> seurat, <span class="dt">selection.method =</span> ??, <span class="dt">nfeatures =</span> <span class="dv">2000</span>, </span>
<span id="cb75-2"><a href="the-following-examples-use-the-pbmc-3k-dataset.html#cb75-2"></a>                               <span class="dt">mean.function =</span> ExpMean, <span class="dt">dispersion.function =</span> LogVMR, </span>
<span id="cb75-3"><a href="the-following-examples-use-the-pbmc-3k-dataset.html#cb75-3"></a>                               <span class="dt">num.bin =</span> ??, </span>
<span id="cb75-4"><a href="the-following-examples-use-the-pbmc-3k-dataset.html#cb75-4"></a>                               <span class="dt">mean.cutoff =</span> <span class="kw">c</span>(??, ??),</span>
<span id="cb75-5"><a href="the-following-examples-use-the-pbmc-3k-dataset.html#cb75-5"></a>                               <span class="dt">dispersion.cutoff =</span> <span class="kw">c</span>(??, ??))</span>
<span id="cb75-6"><a href="the-following-examples-use-the-pbmc-3k-dataset.html#cb75-6"></a></span>
<span id="cb75-7"><a href="the-following-examples-use-the-pbmc-3k-dataset.html#cb75-7"></a><span class="co">## Check number of variable genes</span></span>
<span id="cb75-8"><a href="the-following-examples-use-the-pbmc-3k-dataset.html#cb75-8"></a><span class="kw">length</span>(seurat<span class="op">@</span>assays<span class="op">$</span>RNA<span class="op">@</span>var.features)</span></code></pre></div>
<div class="sourceCode" id="cb76"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb76-1"><a href="the-following-examples-use-the-pbmc-3k-dataset.html#cb76-1"></a>seurat &lt;-<span class="st"> </span><span class="kw">FindVariableFeatures</span>(<span class="dt">object =</span> seurat, <span class="dt">selection.method =</span> ??, <span class="dt">nfeatures =</span> <span class="dv">2000</span>, </span>
<span id="cb76-2"><a href="the-following-examples-use-the-pbmc-3k-dataset.html#cb76-2"></a>                               <span class="dt">mean.function =</span> ExpMean, <span class="dt">dispersion.function =</span> LogVMR, </span>
<span id="cb76-3"><a href="the-following-examples-use-the-pbmc-3k-dataset.html#cb76-3"></a>                               <span class="dt">num.bin =</span> ??, </span>
<span id="cb76-4"><a href="the-following-examples-use-the-pbmc-3k-dataset.html#cb76-4"></a>                               <span class="dt">mean.cutoff =</span> <span class="kw">c</span>(??, ??),</span>
<span id="cb76-5"><a href="the-following-examples-use-the-pbmc-3k-dataset.html#cb76-5"></a>                               <span class="dt">dispersion.cutoff =</span> <span class="kw">c</span>(??, ??))</span>
<span id="cb76-6"><a href="the-following-examples-use-the-pbmc-3k-dataset.html#cb76-6"></a></span>
<span id="cb76-7"><a href="the-following-examples-use-the-pbmc-3k-dataset.html#cb76-7"></a><span class="co">## Check number of variable genes</span></span>
<span id="cb76-8"><a href="the-following-examples-use-the-pbmc-3k-dataset.html#cb76-8"></a><span class="kw">length</span>(seurat<span class="op">@</span>assays<span class="op">$</span>RNA<span class="op">@</span>var.features)</span></code></pre></div>
<div class="sourceCode" id="cb77"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb77-1"><a href="the-following-examples-use-the-pbmc-3k-dataset.html#cb77-1"></a>seurat &lt;-<span class="st"> </span><span class="kw">FindVariableFeatures</span>(<span class="dt">object =</span> seurat, <span class="dt">selection.method =</span> ??, <span class="dt">nfeatures =</span> <span class="dv">2000</span>, </span>
<span id="cb77-2"><a href="the-following-examples-use-the-pbmc-3k-dataset.html#cb77-2"></a>                               <span class="dt">mean.function =</span> ExpMean, <span class="dt">dispersion.function =</span> LogVMR, </span>
<span id="cb77-3"><a href="the-following-examples-use-the-pbmc-3k-dataset.html#cb77-3"></a>                               <span class="dt">num.bin =</span> ??, </span>
<span id="cb77-4"><a href="the-following-examples-use-the-pbmc-3k-dataset.html#cb77-4"></a>                               <span class="dt">mean.cutoff =</span> <span class="kw">c</span>(??, ??),</span>
<span id="cb77-5"><a href="the-following-examples-use-the-pbmc-3k-dataset.html#cb77-5"></a>                               <span class="dt">dispersion.cutoff =</span> <span class="kw">c</span>(??, ??))</span>
<span id="cb77-6"><a href="the-following-examples-use-the-pbmc-3k-dataset.html#cb77-6"></a></span>
<span id="cb77-7"><a href="the-following-examples-use-the-pbmc-3k-dataset.html#cb77-7"></a><span class="co">## Check number of variable genes</span></span>
<span id="cb77-8"><a href="the-following-examples-use-the-pbmc-3k-dataset.html#cb77-8"></a><span class="kw">length</span>(seurat<span class="op">@</span>assays<span class="op">$</span>RNA<span class="op">@</span>var.features)</span></code></pre></div>
<div class="sourceCode" id="cb78"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb78-1"><a href="the-following-examples-use-the-pbmc-3k-dataset.html#cb78-1"></a>seurat &lt;-<span class="st"> </span><span class="kw">FindVariableFeatures</span>(<span class="dt">object =</span> seurat, <span class="dt">selection.method =</span> ??, <span class="dt">nfeatures =</span> <span class="dv">2000</span>, </span>
<span id="cb78-2"><a href="the-following-examples-use-the-pbmc-3k-dataset.html#cb78-2"></a>                               <span class="dt">mean.function =</span> ExpMean, <span class="dt">dispersion.function =</span> LogVMR, </span>
<span id="cb78-3"><a href="the-following-examples-use-the-pbmc-3k-dataset.html#cb78-3"></a>                               <span class="dt">num.bin =</span> ??, </span>
<span id="cb78-4"><a href="the-following-examples-use-the-pbmc-3k-dataset.html#cb78-4"></a>                               <span class="dt">mean.cutoff =</span> <span class="kw">c</span>(??, ??),</span>
<span id="cb78-5"><a href="the-following-examples-use-the-pbmc-3k-dataset.html#cb78-5"></a>                               <span class="dt">dispersion.cutoff =</span> <span class="kw">c</span>(??, ??))</span>
<span id="cb78-6"><a href="the-following-examples-use-the-pbmc-3k-dataset.html#cb78-6"></a></span>
<span id="cb78-7"><a href="the-following-examples-use-the-pbmc-3k-dataset.html#cb78-7"></a><span class="co">## Check number of variable genes</span></span>
<span id="cb78-8"><a href="the-following-examples-use-the-pbmc-3k-dataset.html#cb78-8"></a><span class="kw">length</span>(seurat<span class="op">@</span>assays<span class="op">$</span>RNA<span class="op">@</span>var.features)</span></code></pre></div>
<div class="sourceCode" id="cb79"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb79-1"><a href="the-following-examples-use-the-pbmc-3k-dataset.html#cb79-1"></a><span class="co"># plot variable features with and without labels</span></span>
<span id="cb79-2"><a href="the-following-examples-use-the-pbmc-3k-dataset.html#cb79-2"></a>plot1 &lt;-<span class="st"> </span><span class="kw">VariableFeaturePlot</span>(seurat)</span>
<span id="cb79-3"><a href="the-following-examples-use-the-pbmc-3k-dataset.html#cb79-3"></a>plot2 &lt;-<span class="st"> </span><span class="kw">LabelPoints</span>(<span class="dt">plot =</span> plot1, <span class="dt">points =</span> top10, <span class="dt">repel =</span> <span class="ot">TRUE</span>)</span></code></pre></div>
<pre><code>## When using repel, set xnudge and ynudge to 0 for optimal results</code></pre>
<div class="sourceCode" id="cb81"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb81-1"><a href="the-following-examples-use-the-pbmc-3k-dataset.html#cb81-1"></a><span class="co">## CombinePlots(plots = list(plot1, plot2))</span></span>
<span id="cb81-2"><a href="the-following-examples-use-the-pbmc-3k-dataset.html#cb81-2"></a>plot2</span></code></pre></div>
<p><img src="KrumlovSingleCellWorkshop2020_files/figure-html/plot_vargenes-1.png" width="672" /></p>
</div>
<div id="gene-set-expression-across-cells" class="section level2">
<h2><span class="header-section-number">5.4</span> Gene set expression across cells</h2>
<p>Sometimes we want to ask what is the expression of a set of a genes across cells. This set of genes may make up a gene expression program we are interested in. Another benefit at looking at gene sets is it reduces the effects of drop outs.</p>
<p>Below, we look at genes involved in: T cells, the cell cycle and the stress signature upon cell dissociation. We calculate these genes average expression levels on the single cell level, while controlling for technical effects.</p>
<div class="sourceCode" id="cb82"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb82-1"><a href="the-following-examples-use-the-pbmc-3k-dataset.html#cb82-1"></a><span class="co"># Read in a list of cell cycle markers, from Tirosh et al, 2015.</span></span>
<span id="cb82-2"><a href="the-following-examples-use-the-pbmc-3k-dataset.html#cb82-2"></a><span class="co"># We can segregate this list into markers of G2/M phase and markers of S phase.</span></span>
<span id="cb82-3"><a href="the-following-examples-use-the-pbmc-3k-dataset.html#cb82-3"></a>s.genes &lt;-<span class="st"> </span>Seurat<span class="op">::</span>cc.genes<span class="op">$</span>s.genes</span>
<span id="cb82-4"><a href="the-following-examples-use-the-pbmc-3k-dataset.html#cb82-4"></a>s.genes &lt;-<span class="st"> </span>s.genes[s.genes <span class="op">%in%</span><span class="st"> </span><span class="kw">rownames</span>(seurat)] <span class="co"># genes in dataset</span></span>
<span id="cb82-5"><a href="the-following-examples-use-the-pbmc-3k-dataset.html#cb82-5"></a>g2m.genes &lt;-<span class="st"> </span>Seurat<span class="op">::</span>cc.genes<span class="op">$</span>g2m.genes</span>
<span id="cb82-6"><a href="the-following-examples-use-the-pbmc-3k-dataset.html#cb82-6"></a>g2m.genes &lt;-<span class="st"> </span>g2m.genes[g2m.genes <span class="op">%in%</span><span class="st"> </span><span class="kw">rownames</span>(seurat)] <span class="co"># genes in dataset</span></span>
<span id="cb82-7"><a href="the-following-examples-use-the-pbmc-3k-dataset.html#cb82-7"></a></span>
<span id="cb82-8"><a href="the-following-examples-use-the-pbmc-3k-dataset.html#cb82-8"></a>seurat &lt;-<span class="st"> </span><span class="kw">CellCycleScoring</span>(<span class="dt">object =</span> seurat, <span class="dt">s.features =</span> s.genes, <span class="dt">g2m.features =</span> g2m.genes, <span class="dt">set.ident =</span> <span class="ot">TRUE</span>)</span></code></pre></div>
<p><strong>Task: Use markers for dissociation to calculate dissociation score</strong></p>
<div class="sourceCode" id="cb83"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb83-1"><a href="the-following-examples-use-the-pbmc-3k-dataset.html#cb83-1"></a><span class="co"># Genes upregulated during dissociation of tissue into single cells.</span></span>
<span id="cb83-2"><a href="the-following-examples-use-the-pbmc-3k-dataset.html#cb83-2"></a>genes.dissoc &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;ATF3&quot;</span>, <span class="st">&quot;BTG2&quot;</span>, <span class="st">&quot;CEBPB&quot;</span>, <span class="st">&quot;CEBPD&quot;</span>, <span class="st">&quot;CXCL3&quot;</span>, <span class="st">&quot;CXCL2&quot;</span>, <span class="st">&quot;CXCL1&quot;</span>, <span class="st">&quot;DNAJA1&quot;</span>, <span class="st">&quot;DNAJB1&quot;</span>, <span class="st">&quot;DUSP1&quot;</span>, </span>
<span id="cb83-3"><a href="the-following-examples-use-the-pbmc-3k-dataset.html#cb83-3"></a>                  <span class="st">&quot;EGR1&quot;</span>, <span class="st">&quot;FOS&quot;</span>, <span class="st">&quot;FOSB&quot;</span>, <span class="st">&quot;HSP90AA1&quot;</span>, <span class="st">&quot;HSP90AB1&quot;</span>, <span class="st">&quot;HSPA1A&quot;</span>, <span class="st">&quot;HSPA1B&quot;</span>, <span class="st">&quot;HSPA1A&quot;</span>, <span class="st">&quot;HSPA1B&quot;</span>, </span>
<span id="cb83-4"><a href="the-following-examples-use-the-pbmc-3k-dataset.html#cb83-4"></a>                  <span class="st">&quot;HSPA8&quot;</span>, <span class="st">&quot;HSPB1&quot;</span>, <span class="st">&quot;HSPE1&quot;</span>, <span class="st">&quot;HSPH1&quot;</span>, <span class="st">&quot;ID3&quot;</span>, <span class="st">&quot;IER2&quot;</span>, <span class="st">&quot;JUN&quot;</span>, <span class="st">&quot;JUNB&quot;</span>, <span class="st">&quot;JUND&quot;</span>, <span class="st">&quot;MT1X&quot;</span>, <span class="st">&quot;NFKBIA&quot;</span>, </span>
<span id="cb83-5"><a href="the-following-examples-use-the-pbmc-3k-dataset.html#cb83-5"></a>                  <span class="st">&quot;NR4A1&quot;</span>, <span class="st">&quot;PPP1R15A&quot;</span>, <span class="st">&quot;SOCS3&quot;</span>, <span class="st">&quot;ZFP36&quot;</span>)</span>
<span id="cb83-6"><a href="the-following-examples-use-the-pbmc-3k-dataset.html#cb83-6"></a><span class="co">#### seurat &lt;- ?(?, genes.list = list(?), ctrl.size = 20, enrich.name = &quot;genes_dissoc&quot;)</span></span>
<span id="cb83-7"><a href="the-following-examples-use-the-pbmc-3k-dataset.html#cb83-7"></a>seurat &lt;-<span class="st"> </span><span class="kw">AddModuleScore</span>(seurat, <span class="dt">features =</span> <span class="kw">list</span>(genes.dissoc), <span class="dt">ctrl.size =</span> <span class="dv">20</span>, <span class="dt">enrich.name =</span> <span class="st">&quot;genes_dissoc&quot;</span>)</span></code></pre></div>
<p><strong>Task:</strong>
- Plot the correlation between number of genes and S score.
- How do we know the name of these scores in the seurat meta data?</p>
<div class="sourceCode" id="cb84"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb84-1"><a href="the-following-examples-use-the-pbmc-3k-dataset.html#cb84-1"></a><span class="co">### GenePlot(seurat, &quot;S.Score&quot;, &quot;nGene&quot;)</span></span>
<span id="cb84-2"><a href="the-following-examples-use-the-pbmc-3k-dataset.html#cb84-2"></a><span class="kw">FeatureScatter</span>(seurat, <span class="st">&quot;S.Score&quot;</span>, <span class="st">&quot;nFeature_RNA&quot;</span>)</span></code></pre></div>
<p><strong>Bonus: Can you cluster the data based on the variable genes alone?</strong></p>
<p>Congratulations! You can identify and visualize cell subsets and the marker genes that describe these cell subsets. This is a very powerful analysis pattern often seen in publications. Well done!</p>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="data-wrangling-scrnaseq-1.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="identifying-cell-populations-1.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["KrumlovSingleCellWorkshop2020.pdf", "KrumlovSingleCellWorkshop2020.epub"],
"toc": {
"collapse": "subsection"
}
});
});
</script>

</body>

</html>
